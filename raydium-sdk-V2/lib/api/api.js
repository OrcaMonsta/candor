var yr=Object.create;var je=Object.defineProperty,br=Object.defineProperties,gr=Object.getOwnPropertyDescriptor,Ar=Object.getOwnPropertyDescriptors,wr=Object.getOwnPropertyNames,dt=Object.getOwnPropertySymbols,Pr=Object.getPrototypeOf,jt=Object.prototype.hasOwnProperty,Gn=Object.prototype.propertyIsEnumerable;var Un=(e,t,n)=>t in e?je(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,M=(e,t)=>{for(var n in t||(t={}))jt.call(t,n)&&Un(e,n,t[n]);if(dt)for(var n of dt(t))Gn.call(t,n)&&Un(e,n,t[n]);return e},W=(e,t)=>br(e,Ar(t));var be=(e,t)=>{var n={};for(var o in e)jt.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&dt)for(var o of dt(e))t.indexOf(o)<0&&Gn.call(e,o)&&(n[o]=e[o]);return n};var kr=(e,t)=>{for(var n in t)je(e,n,{get:t[n],enumerable:!0})},Xn=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of wr(t))!jt.call(e,r)&&r!==n&&je(e,r,{get:()=>t[r],enumerable:!(o=gr(t,r))||o.enumerable});return e};var _=(e,t,n)=>(n=e!=null?yr(Pr(e)):{},Xn(t||!e||!e.__esModule?je(n,"default",{value:e,enumerable:!0}):n,e)),hr=e=>Xn(je({},"__esModule",{value:!0}),e);var $a={};kr($a,{Api:()=>Yt,endlessRetry:()=>Ja});module.exports=hr($a);var qn=_(require("axios"));var He=require("lodash");var Ht=class{constructor(t){this.logLevel=t.logLevel!==void 0?t.logLevel:0,this.name=t.name}set level(t){this.logLevel=t}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(t){return t<=this.logLevel}error(...t){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...t),this):this}logWithError(...t){let n=t.map(o=>typeof o=="object"?JSON.stringify(o):o).join(", ");throw new Error(n)}warning(...t){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...t),this):this}info(...t){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...t),this):this}debug(...t){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...t),this):this}},zn={},Tr={};function V(e){let t=(0,He.get)(zn,e);if(!t){let n=(0,He.get)(Tr,e);t=new Ht({name:e,logLevel:n}),(0,He.set)(zn,e,t)}return t}var Ki=require("@solana/web3.js"),Ci=_(require("bn.js"));var wo=_(require("big.js")),Si=_(require("bn.js"));var se=_(require("bn.js"));var Ee=9e15,Ce=1e9,Zt="0123456789abcdef",ft="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",yt="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Jt={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Ee,maxE:Ee,crypto:!1},Hn,ke,N=!0,gt="[DecimalError] ",Ke=gt+"Invalid argument: ",Zn=gt+"Precision limit exceeded",Jn=gt+"crypto unavailable",$n="[object Decimal]",te=Math.floor,j=Math.pow,Ir=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Br=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,xr=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,eo=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,fe=1e7,R=7,Sr=9007199254740991,Kr=ft.length-1,$t=yt.length-1,g={toStringTag:$n};g.absoluteValue=g.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),C(e)};g.ceil=function(){return C(new this.constructor(this),this.e+1,2)};g.clampedTo=g.clamp=function(e,t){var n,o=this,r=o.constructor;if(e=new r(e),t=new r(t),!e.s||!t.s)return new r(NaN);if(e.gt(t))throw Error(Ke+t);return n=o.cmp(e),n<0?e:o.cmp(t)>0?t:new r(o)};g.comparedTo=g.cmp=function(e){var t,n,o,r,i=this,s=i.d,a=(e=new i.constructor(e)).d,u=i.s,l=e.s;if(!s||!a)return!u||!l?NaN:u!==l?u:s===a?0:!s^u<0?1:-1;if(!s[0]||!a[0])return s[0]?u:a[0]?-l:0;if(u!==l)return u;if(i.e!==e.e)return i.e>e.e^u<0?1:-1;for(o=s.length,r=a.length,t=0,n=o<r?o:r;t<n;++t)if(s[t]!==a[t])return s[t]>a[t]^u<0?1:-1;return o===r?0:o>r^u<0?1:-1};g.cosine=g.cos=function(){var e,t,n=this,o=n.constructor;return n.d?n.d[0]?(e=o.precision,t=o.rounding,o.precision=e+Math.max(n.e,n.sd())+R,o.rounding=1,n=Cr(o,io(o,n)),o.precision=e,o.rounding=t,C(ke==2||ke==3?n.neg():n,e,t,!0)):new o(1):new o(NaN)};g.cubeRoot=g.cbrt=function(){var e,t,n,o,r,i,s,a,u,l,m=this,d=m.constructor;if(!m.isFinite()||m.isZero())return new d(m);for(N=!1,i=m.s*j(m.s*m,1/3),!i||Math.abs(i)==1/0?(n=$(m.d),e=m.e,(i=(e-n.length+1)%3)&&(n+=i==1||i==-2?"0":"00"),i=j(n,1/3),e=te((e+1)/3)-(e%3==(e<0?-1:2)),i==1/0?n="5e"+e:(n=i.toExponential(),n=n.slice(0,n.indexOf("e")+1)+e),o=new d(n),o.s=m.s):o=new d(i.toString()),s=(e=d.precision)+3;;)if(a=o,u=a.times(a).times(a),l=u.plus(m),o=G(l.plus(m).times(a),l.plus(u),s+2,1),$(a.d).slice(0,s)===(n=$(o.d)).slice(0,s))if(n=n.slice(s-3,s+1),n=="9999"||!r&&n=="4999"){if(!r&&(C(a,e+1,0),a.times(a).times(a).eq(m))){o=a;break}s+=4,r=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(C(o,e+1,1),t=!o.times(o).times(o).eq(m));break}return N=!0,C(o,e,d.rounding,t)};g.decimalPlaces=g.dp=function(){var e,t=this.d,n=NaN;if(t){if(e=t.length-1,n=(e-te(this.e/R))*R,e=t[e],e)for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n};g.dividedBy=g.div=function(e){return G(this,new this.constructor(e))};g.dividedToIntegerBy=g.divToInt=function(e){var t=this,n=t.constructor;return C(G(t,new n(e),0,1,1),n.precision,n.rounding)};g.equals=g.eq=function(e){return this.cmp(e)===0};g.floor=function(){return C(new this.constructor(this),this.e+1,3)};g.greaterThan=g.gt=function(e){return this.cmp(e)>0};g.greaterThanOrEqualTo=g.gte=function(e){var t=this.cmp(e);return t==1||t===0};g.hyperbolicCosine=g.cosh=function(){var e,t,n,o,r,i=this,s=i.constructor,a=new s(1);if(!i.isFinite())return new s(i.s?1/0:NaN);if(i.isZero())return a;n=s.precision,o=s.rounding,s.precision=n+Math.max(i.e,i.sd())+4,s.rounding=1,r=i.d.length,r<32?(e=Math.ceil(r/3),t=(1/wt(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),i=De(s,1,i.times(t),new s(1),!0);for(var u,l=e,m=new s(8);l--;)u=i.times(i),i=a.minus(u.times(m.minus(u.times(m))));return C(i,s.precision=n,s.rounding=o,!0)};g.hyperbolicSine=g.sinh=function(){var e,t,n,o,r=this,i=r.constructor;if(!r.isFinite()||r.isZero())return new i(r);if(t=i.precision,n=i.rounding,i.precision=t+Math.max(r.e,r.sd())+4,i.rounding=1,o=r.d.length,o<3)r=De(i,2,r,r,!0);else{e=1.4*Math.sqrt(o),e=e>16?16:e|0,r=r.times(1/wt(5,e)),r=De(i,2,r,r,!0);for(var s,a=new i(5),u=new i(16),l=new i(20);e--;)s=r.times(r),r=r.times(a.plus(s.times(u.times(s).plus(l))))}return i.precision=t,i.rounding=n,C(r,t,n,!0)};g.hyperbolicTangent=g.tanh=function(){var e,t,n=this,o=n.constructor;return n.isFinite()?n.isZero()?new o(n):(e=o.precision,t=o.rounding,o.precision=e+7,o.rounding=1,G(n.sinh(),n.cosh(),o.precision=e,o.rounding=t)):new o(n.s)};g.inverseCosine=g.acos=function(){var e,t=this,n=t.constructor,o=t.abs().cmp(1),r=n.precision,i=n.rounding;return o!==-1?o===0?t.isNeg()?pe(n,r,i):new n(0):new n(NaN):t.isZero()?pe(n,r+4,i).times(.5):(n.precision=r+6,n.rounding=1,t=t.asin(),e=pe(n,r+4,i).times(.5),n.precision=r,n.rounding=i,e.minus(t))};g.inverseHyperbolicCosine=g.acosh=function(){var e,t,n=this,o=n.constructor;return n.lte(1)?new o(n.eq(1)?0:NaN):n.isFinite()?(e=o.precision,t=o.rounding,o.precision=e+Math.max(Math.abs(n.e),n.sd())+4,o.rounding=1,N=!1,n=n.times(n).minus(1).sqrt().plus(n),N=!0,o.precision=e,o.rounding=t,n.ln()):new o(n)};g.inverseHyperbolicSine=g.asinh=function(){var e,t,n=this,o=n.constructor;return!n.isFinite()||n.isZero()?new o(n):(e=o.precision,t=o.rounding,o.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,o.rounding=1,N=!1,n=n.times(n).plus(1).sqrt().plus(n),N=!0,o.precision=e,o.rounding=t,n.ln())};g.inverseHyperbolicTangent=g.atanh=function(){var e,t,n,o,r=this,i=r.constructor;return r.isFinite()?r.e>=0?new i(r.abs().eq(1)?r.s/0:r.isZero()?r:NaN):(e=i.precision,t=i.rounding,o=r.sd(),Math.max(o,e)<2*-r.e-1?C(new i(r),e,t,!0):(i.precision=n=o-r.e,r=G(r.plus(1),new i(1).minus(r),n+e,1),i.precision=e+4,i.rounding=1,r=r.ln(),i.precision=e,i.rounding=t,r.times(.5))):new i(NaN)};g.inverseSine=g.asin=function(){var e,t,n,o,r=this,i=r.constructor;return r.isZero()?new i(r):(t=r.abs().cmp(1),n=i.precision,o=i.rounding,t!==-1?t===0?(e=pe(i,n+4,o).times(.5),e.s=r.s,e):new i(NaN):(i.precision=n+6,i.rounding=1,r=r.div(new i(1).minus(r.times(r)).sqrt().plus(1)).atan(),i.precision=n,i.rounding=o,r.times(2)))};g.inverseTangent=g.atan=function(){var e,t,n,o,r,i,s,a,u,l=this,m=l.constructor,d=m.precision,p=m.rounding;if(l.isFinite()){if(l.isZero())return new m(l);if(l.abs().eq(1)&&d+4<=$t)return s=pe(m,d+4,p).times(.25),s.s=l.s,s}else{if(!l.s)return new m(NaN);if(d+4<=$t)return s=pe(m,d+4,p).times(.5),s.s=l.s,s}for(m.precision=a=d+10,m.rounding=1,n=Math.min(28,a/R+2|0),e=n;e;--e)l=l.div(l.times(l).plus(1).sqrt().plus(1));for(N=!1,t=Math.ceil(a/R),o=1,u=l.times(l),s=new m(l),r=l;e!==-1;)if(r=r.times(u),i=s.minus(r.div(o+=2)),r=r.times(u),s=i.plus(r.div(o+=2)),s.d[t]!==void 0)for(e=t;s.d[e]===i.d[e]&&e--;);return n&&(s=s.times(2<<n-1)),N=!0,C(s,m.precision=d,m.rounding=p,!0)};g.isFinite=function(){return!!this.d};g.isInteger=g.isInt=function(){return!!this.d&&te(this.e/R)>this.d.length-2};g.isNaN=function(){return!this.s};g.isNegative=g.isNeg=function(){return this.s<0};g.isPositive=g.isPos=function(){return this.s>0};g.isZero=function(){return!!this.d&&this.d[0]===0};g.lessThan=g.lt=function(e){return this.cmp(e)<0};g.lessThanOrEqualTo=g.lte=function(e){return this.cmp(e)<1};g.logarithm=g.log=function(e){var t,n,o,r,i,s,a,u,l=this,m=l.constructor,d=m.precision,p=m.rounding,b=5;if(e==null)e=new m(10),t=!0;else{if(e=new m(e),n=e.d,e.s<0||!n||!n[0]||e.eq(1))return new m(NaN);t=e.eq(10)}if(n=l.d,l.s<0||!n||!n[0]||l.eq(1))return new m(n&&!n[0]?-1/0:l.s!=1?NaN:n?0:1/0);if(t)if(n.length>1)i=!0;else{for(r=n[0];r%10===0;)r/=10;i=r!==1}if(N=!1,a=d+b,s=Se(l,a),o=t?bt(m,a+10):Se(e,a),u=G(s,o,a,1),Ze(u.d,r=d,p))do if(a+=10,s=Se(l,a),o=t?bt(m,a+10):Se(e,a),u=G(s,o,a,1),!i){+$(u.d).slice(r+1,r+15)+1==1e14&&(u=C(u,d+1,0));break}while(Ze(u.d,r+=10,p));return N=!0,C(u,d,p)};g.minus=g.sub=function(e){var t,n,o,r,i,s,a,u,l,m,d,p,b=this,T=b.constructor;if(e=new T(e),!b.d||!e.d)return!b.s||!e.s?e=new T(NaN):b.d?e.s=-e.s:e=new T(e.d||b.s!==e.s?b:NaN),e;if(b.s!=e.s)return e.s=-e.s,b.plus(e);if(l=b.d,p=e.d,a=T.precision,u=T.rounding,!l[0]||!p[0]){if(p[0])e.s=-e.s;else if(l[0])e=new T(b);else return new T(u===3?-0:0);return N?C(e,a,u):e}if(n=te(e.e/R),m=te(b.e/R),l=l.slice(),i=m-n,i){for(d=i<0,d?(t=l,i=-i,s=p.length):(t=p,n=m,s=l.length),o=Math.max(Math.ceil(a/R),s)+2,i>o&&(i=o,t.length=1),t.reverse(),o=i;o--;)t.push(0);t.reverse()}else{for(o=l.length,s=p.length,d=o<s,d&&(s=o),o=0;o<s;o++)if(l[o]!=p[o]){d=l[o]<p[o];break}i=0}for(d&&(t=l,l=p,p=t,e.s=-e.s),s=l.length,o=p.length-s;o>0;--o)l[s++]=0;for(o=p.length;o>i;){if(l[--o]<p[o]){for(r=o;r&&l[--r]===0;)l[r]=fe-1;--l[r],l[o]+=fe}l[o]-=p[o]}for(;l[--s]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(e.d=l,e.e=At(l,n),N?C(e,a,u):e):new T(u===3?-0:0)};g.modulo=g.mod=function(e){var t,n=this,o=n.constructor;return e=new o(e),!n.d||!e.s||e.d&&!e.d[0]?new o(NaN):!e.d||n.d&&!n.d[0]?C(new o(n),o.precision,o.rounding):(N=!1,o.modulo==9?(t=G(n,e.abs(),0,3,1),t.s*=e.s):t=G(n,e,0,o.modulo,1),t=t.times(e),N=!0,n.minus(t))};g.naturalExponential=g.exp=function(){return en(this)};g.naturalLogarithm=g.ln=function(){return Se(this)};g.negated=g.neg=function(){var e=new this.constructor(this);return e.s=-e.s,C(e)};g.plus=g.add=function(e){var t,n,o,r,i,s,a,u,l,m,d=this,p=d.constructor;if(e=new p(e),!d.d||!e.d)return!d.s||!e.s?e=new p(NaN):d.d||(e=new p(e.d||d.s===e.s?d:NaN)),e;if(d.s!=e.s)return e.s=-e.s,d.minus(e);if(l=d.d,m=e.d,a=p.precision,u=p.rounding,!l[0]||!m[0])return m[0]||(e=new p(d)),N?C(e,a,u):e;if(i=te(d.e/R),o=te(e.e/R),l=l.slice(),r=i-o,r){for(r<0?(n=l,r=-r,s=m.length):(n=m,o=i,s=l.length),i=Math.ceil(a/R),s=i>s?i+1:s+1,r>s&&(r=s,n.length=1),n.reverse();r--;)n.push(0);n.reverse()}for(s=l.length,r=m.length,s-r<0&&(r=s,n=m,m=l,l=n),t=0;r;)t=(l[--r]=l[r]+m[r]+t)/fe|0,l[r]%=fe;for(t&&(l.unshift(t),++o),s=l.length;l[--s]==0;)l.pop();return e.d=l,e.e=At(l,o),N?C(e,a,u):e};g.precision=g.sd=function(e){var t,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ke+e);return n.d?(t=to(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t};g.round=function(){var e=this,t=e.constructor;return C(new t(e),e.e+1,t.rounding)};g.sine=g.sin=function(){var e,t,n=this,o=n.constructor;return n.isFinite()?n.isZero()?new o(n):(e=o.precision,t=o.rounding,o.precision=e+Math.max(n.e,n.sd())+R,o.rounding=1,n=Lr(o,io(o,n)),o.precision=e,o.rounding=t,C(ke>2?n.neg():n,e,t,!0)):new o(NaN)};g.squareRoot=g.sqrt=function(){var e,t,n,o,r,i,s=this,a=s.d,u=s.e,l=s.s,m=s.constructor;if(l!==1||!a||!a[0])return new m(!l||l<0&&(!a||a[0])?NaN:a?s:1/0);for(N=!1,l=Math.sqrt(+s),l==0||l==1/0?(t=$(a),(t.length+u)%2==0&&(t+="0"),l=Math.sqrt(t),u=te((u+1)/2)-(u<0||u%2),l==1/0?t="5e"+u:(t=l.toExponential(),t=t.slice(0,t.indexOf("e")+1)+u),o=new m(t)):o=new m(l.toString()),n=(u=m.precision)+3;;)if(i=o,o=i.plus(G(s,i,n+2,1)).times(.5),$(i.d).slice(0,n)===(t=$(o.d)).slice(0,n))if(t=t.slice(n-3,n+1),t=="9999"||!r&&t=="4999"){if(!r&&(C(i,u+1,0),i.times(i).eq(s))){o=i;break}n+=4,r=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(C(o,u+1,1),e=!o.times(o).eq(s));break}return N=!0,C(o,u,m.rounding,e)};g.tangent=g.tan=function(){var e,t,n=this,o=n.constructor;return n.isFinite()?n.isZero()?new o(n):(e=o.precision,t=o.rounding,o.precision=e+10,o.rounding=1,n=n.sin(),n.s=1,n=G(n,new o(1).minus(n.times(n)).sqrt(),e+10,0),o.precision=e,o.rounding=t,C(ke==2||ke==4?n.neg():n,e,t,!0)):new o(NaN)};g.times=g.mul=function(e){var t,n,o,r,i,s,a,u,l,m=this,d=m.constructor,p=m.d,b=(e=new d(e)).d;if(e.s*=m.s,!p||!p[0]||!b||!b[0])return new d(!e.s||p&&!p[0]&&!b||b&&!b[0]&&!p?NaN:!p||!b?e.s/0:e.s*0);for(n=te(m.e/R)+te(e.e/R),u=p.length,l=b.length,u<l&&(i=p,p=b,b=i,s=u,u=l,l=s),i=[],s=u+l,o=s;o--;)i.push(0);for(o=l;--o>=0;){for(t=0,r=u+o;r>o;)a=i[r]+b[o]*p[r-o-1]+t,i[r--]=a%fe|0,t=a/fe|0;i[r]=(i[r]+t)%fe|0}for(;!i[--s];)i.pop();return t?++n:i.shift(),e.d=i,e.e=At(i,n),N?C(e,d.precision,d.rounding):e};g.toBinary=function(e,t){return nn(this,2,e,t)};g.toDecimalPlaces=g.toDP=function(e,t){var n=this,o=n.constructor;return n=new o(n),e===void 0?n:(ue(e,0,Ce),t===void 0?t=o.rounding:ue(t,0,8),C(n,e+n.e+1,t))};g.toExponential=function(e,t){var n,o=this,r=o.constructor;return e===void 0?n=ge(o,!0):(ue(e,0,Ce),t===void 0?t=r.rounding:ue(t,0,8),o=C(new r(o),e+1,t),n=ge(o,!0,e+1)),o.isNeg()&&!o.isZero()?"-"+n:n};g.toFixed=function(e,t){var n,o,r=this,i=r.constructor;return e===void 0?n=ge(r):(ue(e,0,Ce),t===void 0?t=i.rounding:ue(t,0,8),o=C(new i(r),e+r.e+1,t),n=ge(o,!1,e+o.e+1)),r.isNeg()&&!r.isZero()?"-"+n:n};g.toFraction=function(e){var t,n,o,r,i,s,a,u,l,m,d,p,b=this,T=b.d,w=b.constructor;if(!T)return new w(b);if(l=n=new w(1),o=u=new w(0),t=new w(o),i=t.e=to(T)-b.e-1,s=i%R,t.d[0]=j(10,s<0?R+s:s),e==null)e=i>0?t:l;else{if(a=new w(e),!a.isInt()||a.lt(l))throw Error(Ke+a);e=a.gt(t)?i>0?t:l:a}for(N=!1,a=new w($(T)),m=w.precision,w.precision=i=T.length*R*2;d=G(a,t,0,1,1),r=n.plus(d.times(o)),r.cmp(e)!=1;)n=o,o=r,r=l,l=u.plus(d.times(r)),u=r,r=t,t=a.minus(d.times(r)),a=r;return r=G(e.minus(n),o,0,1,1),u=u.plus(r.times(l)),n=n.plus(r.times(o)),u.s=l.s=b.s,p=G(l,o,i,1).minus(b).abs().cmp(G(u,n,i,1).minus(b).abs())<1?[l,o]:[u,n],w.precision=m,N=!0,p};g.toHexadecimal=g.toHex=function(e,t){return nn(this,16,e,t)};g.toNearest=function(e,t){var n=this,o=n.constructor;if(n=new o(n),e==null){if(!n.d)return n;e=new o(1),t=o.rounding}else{if(e=new o(e),t===void 0?t=o.rounding:ue(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(N=!1,n=G(n,e,0,t,1).times(e),N=!0,C(n)):(e.s=n.s,n=e),n};g.toNumber=function(){return+this};g.toOctal=function(e,t){return nn(this,8,e,t)};g.toPower=g.pow=function(e){var t,n,o,r,i,s,a=this,u=a.constructor,l=+(e=new u(e));if(!a.d||!e.d||!a.d[0]||!e.d[0])return new u(j(+a,l));if(a=new u(a),a.eq(1))return a;if(o=u.precision,i=u.rounding,e.eq(1))return C(a,o,i);if(t=te(e.e/R),t>=e.d.length-1&&(n=l<0?-l:l)<=Sr)return r=no(u,a,n,o),e.s<0?new u(1).div(r):C(r,o,i);if(s=a.s,s<0){if(t<e.d.length-1)return new u(NaN);if((e.d[t]&1)==0&&(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return n=j(+a,l),t=n==0||!isFinite(n)?te(l*(Math.log("0."+$(a.d))/Math.LN10+a.e+1)):new u(n+"").e,t>u.maxE+1||t<u.minE-1?new u(t>0?s/0:0):(N=!1,u.rounding=a.s=1,n=Math.min(12,(t+"").length),r=en(e.times(Se(a,o+n)),o),r.d&&(r=C(r,o+5,1),Ze(r.d,o,i)&&(t=o+10,r=C(en(e.times(Se(a,t+n)),t),t+5,1),+$(r.d).slice(o+1,o+15)+1==1e14&&(r=C(r,o+1,0)))),r.s=s,N=!0,u.rounding=i,C(r,o,i))};g.toPrecision=function(e,t){var n,o=this,r=o.constructor;return e===void 0?n=ge(o,o.e<=r.toExpNeg||o.e>=r.toExpPos):(ue(e,1,Ce),t===void 0?t=r.rounding:ue(t,0,8),o=C(new r(o),e,t),n=ge(o,e<=o.e||o.e<=r.toExpNeg,e)),o.isNeg()&&!o.isZero()?"-"+n:n};g.toSignificantDigits=g.toSD=function(e,t){var n=this,o=n.constructor;return e===void 0?(e=o.precision,t=o.rounding):(ue(e,1,Ce),t===void 0?t=o.rounding:ue(t,0,8)),C(new o(n),e,t)};g.toString=function(){var e=this,t=e.constructor,n=ge(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n};g.truncated=g.trunc=function(){return C(new this.constructor(this),this.e+1,1)};g.valueOf=g.toJSON=function(){var e=this,t=e.constructor,n=ge(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};function $(e){var t,n,o,r=e.length-1,i="",s=e[0];if(r>0){for(i+=s,t=1;t<r;t++)o=e[t]+"",n=R-o.length,n&&(i+=xe(n)),i+=o;s=e[t],o=s+"",n=R-o.length,n&&(i+=xe(n))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}function ue(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Ke+e)}function Ze(e,t,n,o){var r,i,s,a;for(i=e[0];i>=10;i/=10)--t;return--t<0?(t+=R,r=0):(r=Math.ceil((t+1)/R),t%=R),i=j(10,R-t),a=e[r]%i|0,o==null?t<3?(t==0?a=a/100|0:t==1&&(a=a/10|0),s=n<4&&a==99999||n>3&&a==49999||a==5e4||a==0):s=(n<4&&a+1==i||n>3&&a+1==i/2)&&(e[r+1]/i/100|0)==j(10,t-2)-1||(a==i/2||a==0)&&(e[r+1]/i/100|0)==0:t<4?(t==0?a=a/1e3|0:t==1?a=a/100|0:t==2&&(a=a/10|0),s=(o||n<4)&&a==9999||!o&&n>3&&a==4999):s=((o||n<4)&&a+1==i||!o&&n>3&&a+1==i/2)&&(e[r+1]/i/1e3|0)==j(10,t-3)-1,s}function pt(e,t,n){for(var o,r=[0],i,s=0,a=e.length;s<a;){for(i=r.length;i--;)r[i]*=t;for(r[0]+=Zt.indexOf(e.charAt(s++)),o=0;o<r.length;o++)r[o]>n-1&&(r[o+1]===void 0&&(r[o+1]=0),r[o+1]+=r[o]/n|0,r[o]%=n)}return r.reverse()}function Cr(e,t){var n,o,r;if(t.isZero())return t;o=t.d.length,o<32?(n=Math.ceil(o/3),r=(1/wt(4,n)).toString()):(n=16,r="2.3283064365386962890625e-10"),e.precision+=n,t=De(e,1,t.times(r),new e(1));for(var i=n;i--;){var s=t.times(t);t=s.times(s).minus(s).times(8).plus(1)}return e.precision-=n,t}var G=function(){function e(o,r,i){var s,a=0,u=o.length;for(o=o.slice();u--;)s=o[u]*r+a,o[u]=s%i|0,a=s/i|0;return a&&o.unshift(a),o}function t(o,r,i,s){var a,u;if(i!=s)u=i>s?1:-1;else for(a=u=0;a<i;a++)if(o[a]!=r[a]){u=o[a]>r[a]?1:-1;break}return u}function n(o,r,i,s){for(var a=0;i--;)o[i]-=a,a=o[i]<r[i]?1:0,o[i]=a*s+o[i]-r[i];for(;!o[0]&&o.length>1;)o.shift()}return function(o,r,i,s,a,u){var l,m,d,p,b,T,w,S,I,k,A,P,E,L,Y,v,z,ee,Z,de,Oe=o.constructor,Fe=o.s==r.s?1:-1,J=o.d,X=r.d;if(!J||!J[0]||!X||!X[0])return new Oe(!o.s||!r.s||(J?X&&J[0]==X[0]:!X)?NaN:J&&J[0]==0||!X?Fe*0:Fe/0);for(u?(b=1,m=o.e-r.e):(u=fe,b=R,m=te(o.e/b)-te(r.e/b)),Z=X.length,z=J.length,I=new Oe(Fe),k=I.d=[],d=0;X[d]==(J[d]||0);d++);if(X[d]>(J[d]||0)&&m--,i==null?(L=i=Oe.precision,s=Oe.rounding):a?L=i+(o.e-r.e)+1:L=i,L<0)k.push(1),T=!0;else{if(L=L/b+2|0,d=0,Z==1){for(p=0,X=X[0],L++;(d<z||p)&&L--;d++)Y=p*u+(J[d]||0),k[d]=Y/X|0,p=Y%X|0;T=p||d<z}else{for(p=u/(X[0]+1)|0,p>1&&(X=e(X,p,u),J=e(J,p,u),Z=X.length,z=J.length),v=Z,A=J.slice(0,Z),P=A.length;P<Z;)A[P++]=0;de=X.slice(),de.unshift(0),ee=X[0],X[1]>=u/2&&++ee;do p=0,l=t(X,A,Z,P),l<0?(E=A[0],Z!=P&&(E=E*u+(A[1]||0)),p=E/ee|0,p>1?(p>=u&&(p=u-1),w=e(X,p,u),S=w.length,P=A.length,l=t(w,A,S,P),l==1&&(p--,n(w,Z<S?de:X,S,u))):(p==0&&(l=p=1),w=X.slice()),S=w.length,S<P&&w.unshift(0),n(A,w,P,u),l==-1&&(P=A.length,l=t(X,A,Z,P),l<1&&(p++,n(A,Z<P?de:X,P,u))),P=A.length):l===0&&(p++,A=[0]),k[d++]=p,l&&A[0]?A[P++]=J[v]||0:(A=[J[v]],P=1);while((v++<z||A[0]!==void 0)&&L--);T=A[0]!==void 0}k[0]||k.shift()}if(b==1)I.e=m,Hn=T;else{for(d=1,p=k[0];p>=10;p/=10)d++;I.e=d+m*b-1,C(I,a?i+I.e+1:i,s,T)}return I}}();function C(e,t,n,o){var r,i,s,a,u,l,m,d,p,b=e.constructor;e:if(t!=null){if(d=e.d,!d)return e;for(r=1,a=d[0];a>=10;a/=10)r++;if(i=t-r,i<0)i+=R,s=t,m=d[p=0],u=m/j(10,r-s-1)%10|0;else if(p=Math.ceil((i+1)/R),a=d.length,p>=a)if(o){for(;a++<=p;)d.push(0);m=u=0,r=1,i%=R,s=i-R+1}else break e;else{for(m=a=d[p],r=1;a>=10;a/=10)r++;i%=R,s=i-R+r,u=s<0?0:m/j(10,r-s-1)%10|0}if(o=o||t<0||d[p+1]!==void 0||(s<0?m:m%j(10,r-s-1)),l=n<4?(u||o)&&(n==0||n==(e.s<0?3:2)):u>5||u==5&&(n==4||o||n==6&&(i>0?s>0?m/j(10,r-s):0:d[p-1])%10&1||n==(e.s<0?8:7)),t<1||!d[0])return d.length=0,l?(t-=e.e+1,d[0]=j(10,(R-t%R)%R),e.e=-t||0):d[0]=e.e=0,e;if(i==0?(d.length=p,a=1,p--):(d.length=p+1,a=j(10,R-i),d[p]=s>0?(m/j(10,r-s)%j(10,s)|0)*a:0),l)for(;;)if(p==0){for(i=1,s=d[0];s>=10;s/=10)i++;for(s=d[0]+=a,a=1;s>=10;s/=10)a++;i!=a&&(e.e++,d[0]==fe&&(d[0]=1));break}else{if(d[p]+=a,d[p]!=fe)break;d[p--]=0,a=1}for(i=d.length;d[--i]===0;)d.pop()}return N&&(e.e>b.maxE?(e.d=null,e.e=NaN):e.e<b.minE&&(e.e=0,e.d=[0])),e}function ge(e,t,n){if(!e.isFinite())return ro(e);var o,r=e.e,i=$(e.d),s=i.length;return t?(n&&(o=n-s)>0?i=i.charAt(0)+"."+i.slice(1)+xe(o):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(e.e<0?"e":"e+")+e.e):r<0?(i="0."+xe(-r-1)+i,n&&(o=n-s)>0&&(i+=xe(o))):r>=s?(i+=xe(r+1-s),n&&(o=n-r-1)>0&&(i=i+"."+xe(o))):((o=r+1)<s&&(i=i.slice(0,o)+"."+i.slice(o)),n&&(o=n-s)>0&&(r+1===s&&(i+="."),i+=xe(o))),i}function At(e,t){var n=e[0];for(t*=R;n>=10;n/=10)t++;return t}function bt(e,t,n){if(t>Kr)throw N=!0,n&&(e.precision=n),Error(Zn);return C(new e(ft),t,1,!0)}function pe(e,t,n){if(t>$t)throw Error(Zn);return C(new e(yt),t,n,!0)}function to(e){var t=e.length-1,n=t*R+1;if(t=e[t],t){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function xe(e){for(var t="";e--;)t+="0";return t}function no(e,t,n,o){var r,i=new e(1),s=Math.ceil(o/R+4);for(N=!1;;){if(n%2&&(i=i.times(t),Yn(i.d,s)&&(r=!0)),n=te(n/2),n===0){n=i.d.length-1,r&&i.d[n]===0&&++i.d[n];break}t=t.times(t),Yn(t.d,s)}return N=!0,i}function Qn(e){return e.d[e.d.length-1]&1}function oo(e,t,n){for(var o,r=new e(t[0]),i=0;++i<t.length;)if(o=new e(t[i]),o.s)r[n](o)&&(r=o);else{r=o;break}return r}function en(e,t){var n,o,r,i,s,a,u,l=0,m=0,d=0,p=e.constructor,b=p.rounding,T=p.precision;if(!e.d||!e.d[0]||e.e>17)return new p(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:0/0);for(t==null?(N=!1,u=T):u=t,a=new p(.03125);e.e>-2;)e=e.times(a),d+=5;for(o=Math.log(j(2,d))/Math.LN10*2+5|0,u+=o,n=i=s=new p(1),p.precision=u;;){if(i=C(i.times(e),u,1),n=n.times(++m),a=s.plus(G(i,n,u,1)),$(a.d).slice(0,u)===$(s.d).slice(0,u)){for(r=d;r--;)s=C(s.times(s),u,1);if(t==null)if(l<3&&Ze(s.d,u-o,b,l))p.precision=u+=10,n=i=a=new p(1),m=0,l++;else return C(s,p.precision=T,b,N=!0);else return p.precision=T,s}s=a}}function Se(e,t){var n,o,r,i,s,a,u,l,m,d,p,b=1,T=10,w=e,S=w.d,I=w.constructor,k=I.rounding,A=I.precision;if(w.s<0||!S||!S[0]||!w.e&&S[0]==1&&S.length==1)return new I(S&&!S[0]?-1/0:w.s!=1?NaN:S?0:w);if(t==null?(N=!1,m=A):m=t,I.precision=m+=T,n=$(S),o=n.charAt(0),Math.abs(i=w.e)<15e14){for(;o<7&&o!=1||o==1&&n.charAt(1)>3;)w=w.times(e),n=$(w.d),o=n.charAt(0),b++;i=w.e,o>1?(w=new I("0."+n),i++):w=new I(o+"."+n.slice(1))}else return l=bt(I,m+2,A).times(i+""),w=Se(new I(o+"."+n.slice(1)),m-T).plus(l),I.precision=A,t==null?C(w,A,k,N=!0):w;for(d=w,u=s=w=G(w.minus(1),w.plus(1),m,1),p=C(w.times(w),m,1),r=3;;){if(s=C(s.times(p),m,1),l=u.plus(G(s,new I(r),m,1)),$(l.d).slice(0,m)===$(u.d).slice(0,m))if(u=u.times(2),i!==0&&(u=u.plus(bt(I,m+2,A).times(i+""))),u=G(u,new I(b),m,1),t==null)if(Ze(u.d,m-T,k,a))I.precision=m+=T,l=s=w=G(d.minus(1),d.plus(1),m,1),p=C(w.times(w),m,1),r=a=1;else return C(u,I.precision=A,k,N=!0);else return I.precision=A,u;u=l,r+=2}}function ro(e){return String(e.s*e.s/0)}function tn(e,t){var n,o,r;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(o=t.search(/e/i))>0?(n<0&&(n=o),n+=+t.slice(o+1),t=t.substring(0,o)):n<0&&(n=t.length),o=0;t.charCodeAt(o)===48;o++);for(r=t.length;t.charCodeAt(r-1)===48;--r);if(t=t.slice(o,r),t){if(r-=o,e.e=n=n-o-1,e.d=[],o=(n+1)%R,n<0&&(o+=R),o<r){for(o&&e.d.push(+t.slice(0,o)),r-=R;o<r;)e.d.push(+t.slice(o,o+=R));t=t.slice(o),o=R-t.length}else o-=r;for(;o--;)t+="0";e.d.push(+t),N&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Rr(e,t){var n,o,r,i,s,a,u,l,m;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),eo.test(t))return tn(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(Br.test(t))n=16,t=t.toLowerCase();else if(Ir.test(t))n=2;else if(xr.test(t))n=8;else throw Error(Ke+t);for(i=t.search(/p/i),i>0?(u=+t.slice(i+1),t=t.substring(2,i)):t=t.slice(2),i=t.indexOf("."),s=i>=0,o=e.constructor,s&&(t=t.replace(".",""),a=t.length,i=a-i,r=no(o,new o(n),i,i*2)),l=pt(t,n,fe),m=l.length-1,i=m;l[i]===0;--i)l.pop();return i<0?new o(e.s*0):(e.e=At(l,m),e.d=l,N=!1,s&&(e=G(e,r,a*4)),u&&(e=e.times(Math.abs(u)<54?j(2,u):Pt.pow(2,u))),N=!0,e)}function Lr(e,t){var n,o=t.d.length;if(o<3)return t.isZero()?t:De(e,2,t,t);n=1.4*Math.sqrt(o),n=n>16?16:n|0,t=t.times(1/wt(5,n)),t=De(e,2,t,t);for(var r,i=new e(5),s=new e(16),a=new e(20);n--;)r=t.times(t),t=t.times(i.plus(r.times(s.times(r).minus(a))));return t}function De(e,t,n,o,r){var i,s,a,u,l=1,m=e.precision,d=Math.ceil(m/R);for(N=!1,u=n.times(n),a=new e(o);;){if(s=G(a.times(u),new e(t++*t++),m,1),a=r?o.plus(s):o.minus(s),o=G(s.times(u),new e(t++*t++),m,1),s=a.plus(o),s.d[d]!==void 0){for(i=d;s.d[i]===a.d[i]&&i--;);if(i==-1)break}i=a,a=o,o=s,s=i,l++}return N=!0,s.d.length=d+1,s}function wt(e,t){for(var n=e;--t;)n*=e;return n}function io(e,t){var n,o=t.s<0,r=pe(e,e.precision,1),i=r.times(.5);if(t=t.abs(),t.lte(i))return ke=o?4:1,t;if(n=t.divToInt(r),n.isZero())ke=o?3:2;else{if(t=t.minus(n.times(r)),t.lte(i))return ke=Qn(n)?o?2:3:o?4:1,t;ke=Qn(n)?o?1:4:o?3:2}return t.minus(r).abs()}function nn(e,t,n,o){var r,i,s,a,u,l,m,d,p,b=e.constructor,T=n!==void 0;if(T?(ue(n,1,Ce),o===void 0?o=b.rounding:ue(o,0,8)):(n=b.precision,o=b.rounding),!e.isFinite())m=ro(e);else{for(m=ge(e),s=m.indexOf("."),T?(r=2,t==16?n=n*4-3:t==8&&(n=n*3-2)):r=t,s>=0&&(m=m.replace(".",""),p=new b(1),p.e=m.length-s,p.d=pt(ge(p),10,r),p.e=p.d.length),d=pt(m,10,r),i=u=d.length;d[--u]==0;)d.pop();if(!d[0])m=T?"0p+0":"0";else{if(s<0?i--:(e=new b(e),e.d=d,e.e=i,e=G(e,p,n,o,0,r),d=e.d,i=e.e,l=Hn),s=d[n],a=r/2,l=l||d[n+1]!==void 0,l=o<4?(s!==void 0||l)&&(o===0||o===(e.s<0?3:2)):s>a||s===a&&(o===4||l||o===6&&d[n-1]&1||o===(e.s<0?8:7)),d.length=n,l)for(;++d[--n]>r-1;)d[n]=0,n||(++i,d.unshift(1));for(u=d.length;!d[u-1];--u);for(s=0,m="";s<u;s++)m+=Zt.charAt(d[s]);if(T){if(u>1)if(t==16||t==8){for(s=t==16?4:3,--u;u%s;u++)m+="0";for(d=pt(m,r,t),u=d.length;!d[u-1];--u);for(s=1,m="1.";s<u;s++)m+=Zt.charAt(d[s])}else m=m.charAt(0)+"."+m.slice(1);m=m+(i<0?"p":"p+")+i}else if(i<0){for(;++i;)m="0"+m;m="0."+m}else if(++i>u)for(i-=u;i--;)m+="0";else i<u&&(m=m.slice(0,i)+"."+m.slice(i))}m=(t==16?"0x":t==2?"0b":t==8?"0o":"")+m}return e.s<0?"-"+m:m}function Yn(e,t){if(e.length>t)return e.length=t,!0}function Or(e){return new this(e).abs()}function Nr(e){return new this(e).acos()}function Mr(e){return new this(e).acosh()}function vr(e,t){return new this(e).plus(t)}function _r(e){return new this(e).asin()}function Vr(e){return new this(e).asinh()}function Fr(e){return new this(e).atan()}function Er(e){return new this(e).atanh()}function Dr(e,t){e=new this(e),t=new this(t);var n,o=this.precision,r=this.rounding,i=o+4;return!e.s||!t.s?n=new this(NaN):!e.d&&!t.d?(n=pe(this,i,1).times(t.s>0?.25:.75),n.s=e.s):!t.d||e.isZero()?(n=t.s<0?pe(this,o,r):new this(0),n.s=e.s):!e.d||t.isZero()?(n=pe(this,i,1).times(.5),n.s=e.s):t.s<0?(this.precision=i,this.rounding=1,n=this.atan(G(e,t,i,1)),t=pe(this,i,1),this.precision=o,this.rounding=r,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(G(e,t,i,1)),n}function Wr(e){return new this(e).cbrt()}function qr(e){return C(e=new this(e),e.e+1,2)}function Ur(e,t,n){return new this(e).clamp(t,n)}function Gr(e){if(!e||typeof e!="object")throw Error(gt+"Object expected");var t,n,o,r=e.defaults===!0,i=["precision",1,Ce,"rounding",0,8,"toExpNeg",-Ee,0,"toExpPos",0,Ee,"maxE",0,Ee,"minE",-Ee,0,"modulo",0,9];for(t=0;t<i.length;t+=3)if(n=i[t],r&&(this[n]=Jt[n]),(o=e[n])!==void 0)if(te(o)===o&&o>=i[t+1]&&o<=i[t+2])this[n]=o;else throw Error(Ke+n+": "+o);if(n="crypto",r&&(this[n]=Jt[n]),(o=e[n])!==void 0)if(o===!0||o===!1||o===0||o===1)if(o)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(Jn);else this[n]=!1;else throw Error(Ke+n+": "+o);return this}function Xr(e){return new this(e).cos()}function zr(e){return new this(e).cosh()}function so(e){var t,n,o;function r(i){var s,a,u,l=this;if(!(l instanceof r))return new r(i);if(l.constructor=r,jn(i)){l.s=i.s,N?!i.d||i.e>r.maxE?(l.e=NaN,l.d=null):i.e<r.minE?(l.e=0,l.d=[0]):(l.e=i.e,l.d=i.d.slice()):(l.e=i.e,l.d=i.d?i.d.slice():i.d);return}if(u=typeof i,u==="number"){if(i===0){l.s=1/i<0?-1:1,l.e=0,l.d=[0];return}if(i<0?(i=-i,l.s=-1):l.s=1,i===~~i&&i<1e7){for(s=0,a=i;a>=10;a/=10)s++;N?s>r.maxE?(l.e=NaN,l.d=null):s<r.minE?(l.e=0,l.d=[0]):(l.e=s,l.d=[i]):(l.e=s,l.d=[i]);return}else if(i*0!==0){i||(l.s=NaN),l.e=NaN,l.d=null;return}return tn(l,i.toString())}else if(u!=="string")throw Error(Ke+i);return(a=i.charCodeAt(0))===45?(i=i.slice(1),l.s=-1):(a===43&&(i=i.slice(1)),l.s=1),eo.test(i)?tn(l,i):Rr(l,i)}if(r.prototype=g,r.ROUND_UP=0,r.ROUND_DOWN=1,r.ROUND_CEIL=2,r.ROUND_FLOOR=3,r.ROUND_HALF_UP=4,r.ROUND_HALF_DOWN=5,r.ROUND_HALF_EVEN=6,r.ROUND_HALF_CEIL=7,r.ROUND_HALF_FLOOR=8,r.EUCLID=9,r.config=r.set=Gr,r.clone=so,r.isDecimal=jn,r.abs=Or,r.acos=Nr,r.acosh=Mr,r.add=vr,r.asin=_r,r.asinh=Vr,r.atan=Fr,r.atanh=Er,r.atan2=Dr,r.cbrt=Wr,r.ceil=qr,r.clamp=Ur,r.cos=Xr,r.cosh=zr,r.div=Qr,r.exp=Yr,r.floor=jr,r.hypot=Hr,r.ln=Zr,r.log=Jr,r.log10=ei,r.log2=$r,r.max=ti,r.min=ni,r.mod=oi,r.mul=ri,r.pow=ii,r.random=si,r.round=ai,r.sign=ui,r.sin=ci,r.sinh=li,r.sqrt=mi,r.sub=di,r.sum=pi,r.tan=fi,r.tanh=yi,r.trunc=bi,e===void 0&&(e={}),e&&e.defaults!==!0)for(o=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<o.length;)e.hasOwnProperty(n=o[t++])||(e[n]=this[n]);return r.config(e),r}function Qr(e,t){return new this(e).div(t)}function Yr(e){return new this(e).exp()}function jr(e){return C(e=new this(e),e.e+1,3)}function Hr(){var e,t,n=new this(0);for(N=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return N=!0,new this(1/0);n=t}return N=!0,n.sqrt()}function jn(e){return e instanceof Pt||e&&e.toStringTag===$n||!1}function Zr(e){return new this(e).ln()}function Jr(e,t){return new this(e).log(t)}function $r(e){return new this(e).log(2)}function ei(e){return new this(e).log(10)}function ti(){return oo(this,arguments,"lt")}function ni(){return oo(this,arguments,"gt")}function oi(e,t){return new this(e).mod(t)}function ri(e,t){return new this(e).mul(t)}function ii(e,t){return new this(e).pow(t)}function si(e){var t,n,o,r,i=0,s=new this(1),a=[];if(e===void 0?e=this.precision:ue(e,1,Ce),o=Math.ceil(e/R),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(o));i<o;)r=t[i],r>=429e7?t[i]=crypto.getRandomValues(new Uint32Array(1))[0]:a[i++]=r%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(o*=4);i<o;)r=t[i]+(t[i+1]<<8)+(t[i+2]<<16)+((t[i+3]&127)<<24),r>=214e7?crypto.randomBytes(4).copy(t,i):(a.push(r%1e7),i+=4);i=o/4}else throw Error(Jn);else for(;i<o;)a[i++]=Math.random()*1e7|0;for(o=a[--i],e%=R,o&&e&&(r=j(10,R-e),a[i]=(o/r|0)*r);a[i]===0;i--)a.pop();if(i<0)n=0,a=[0];else{for(n=-1;a[0]===0;n-=R)a.shift();for(o=1,r=a[0];r>=10;r/=10)o++;o<R&&(n-=R-o)}return s.e=n,s.d=a,s}function ai(e){return C(e=new this(e),e.e+1,this.rounding)}function ui(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function ci(e){return new this(e).sin()}function li(e){return new this(e).sinh()}function mi(e){return new this(e).sqrt()}function di(e,t){return new this(e).sub(t)}function pi(){var e=0,t=arguments,n=new this(t[e]);for(N=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return N=!0,C(n,this.precision,this.rounding)}function fi(e){return new this(e).tan()}function yi(e){return new this(e).tanh()}function bi(e){return C(e=new this(e),e.e+1,1)}g[Symbol.for("nodejs.util.inspect.custom")]=g.toString;g[Symbol.toStringTag]="Decimal";var Pt=g.constructor=so(Jt);ft=new Pt(ft);yt=new Pt(yt);var ht=require("@solana/web3.js");var ao=require("@solana/spl-token"),D=require("@solana/web3.js");function We({pubkey:e,isSigner:t=!1,isWritable:n=!0}){return{pubkey:e,isWritable:n,isSigner:t}}var gi=[We({pubkey:ao.TOKEN_PROGRAM_ID,isWritable:!1}),We({pubkey:D.SystemProgram.programId,isWritable:!1}),We({pubkey:D.SYSVAR_RENT_PUBKEY,isWritable:!1})];function on({publicKey:e,transformSol:t}){let n=uo(e.toString());if(n instanceof D.PublicKey)return t&&n.equals(Ne)?Ae:n;if(t&&n.toString()===Ne.toBase58())return Ae;if(typeof n=="string"){if(n===D.PublicKey.default.toBase58())return D.PublicKey.default;try{return new D.PublicKey(n)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function uo(e){try{return new D.PublicKey(e)}catch{return e}}var Ai=new D.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),co=new D.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),Je=new D.PublicKey("SysvarRent111111111111111111111111111111111"),wi=new D.PublicKey("SysvarC1ock11111111111111111111111111111111"),lo=new D.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),Pi=new D.PublicKey("Sysvar1nstructions1111111111111111111111111"),mo=D.SystemProgram.programId,ru=new D.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),iu=new D.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),su=new D.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),au=new D.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),uu=new D.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),cu=new D.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),lu=new D.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),mu=new D.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),du=new D.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),pu=new D.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),fu=new D.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Ae=new D.PublicKey("So11111111111111111111111111111111111111112"),Ne=D.PublicKey.default;function Me(e){return on({publicKey:e,transformSol:!0})}var po=require("@solana/web3.js"),rn=require("@solana/spl-token"),kt={chainId:101,address:po.PublicKey.default.toBase58(),programId:rn.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},we={chainId:101,address:"So11111111111111111111111111111111111111112",programId:rn.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var sn=class{constructor({mint:t,decimals:n,symbol:o,name:r,skipMint:i=!1,isToken2022:s=!1}){if(t===Ne.toBase58()||t instanceof ht.PublicKey&&Ne.equals(t)){this.decimals=we.decimals,this.symbol=we.symbol,this.name=we.name,this.mint=new ht.PublicKey(we.address),this.isToken2022=!1;return}this.decimals=n,this.symbol=o||t.toString().substring(0,6),this.name=r||t.toString().substring(0,6),this.mint=i?ht.PublicKey.default:on({publicKey:t}),this.isToken2022=s}equals(t){return this===t?!0:this.mint.equals(t.mint)}},ne=sn;ne.WSOL=new sn(W(M({},we),{mint:we.address}));var et=_(require("big.js")),yo=_(require("bn.js")),bo=_(require("decimal.js-light"));var fo=_(require("toformat")),ki=fo.default,$e=ki;var Tt=V("module/fraction"),an=$e(et.default),tt=$e(bo.default),hi={[0]:tt.ROUND_DOWN,[1]:tt.ROUND_HALF_UP,[2]:tt.ROUND_UP},Ti={[0]:et.default.roundDown,[1]:et.default.roundHalfUp,[2]:et.default.roundUp},Q=class{constructor(t,n=new yo.default(1)){this.numerator=ie(t),this.denominator=ie(n)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new Q(this.denominator,this.numerator)}add(t){let n=t instanceof Q?t:new Q(ie(t));return this.denominator.eq(n.denominator)?new Q(this.numerator.add(n.numerator),this.denominator):new Q(this.numerator.mul(n.denominator).add(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}sub(t){let n=t instanceof Q?t:new Q(ie(t));return this.denominator.eq(n.denominator)?new Q(this.numerator.sub(n.numerator),this.denominator):new Q(this.numerator.mul(n.denominator).sub(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}mul(t){let n=t instanceof Q?t:new Q(ie(t));return new Q(this.numerator.mul(n.numerator),this.denominator.mul(n.denominator))}div(t){let n=t instanceof Q?t:new Q(ie(t));return new Q(this.numerator.mul(n.denominator),this.denominator.mul(n.numerator))}toSignificant(t,n={groupSeparator:""},o=1){Number.isInteger(t)||Tt.logWithError(`${t} is not an integer.`),t<=0&&Tt.logWithError(`${t} is not positive.`),tt.set({precision:t+1,rounding:hi[o]});let r=new tt(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return r.toFormat(r.decimalPlaces(),n)}toFixed(t,n={groupSeparator:""},o=1){return Number.isInteger(t)||Tt.logWithError(`${t} is not an integer.`),t<0&&Tt.logWithError(`${t} is negative.`),an.DP=t,an.RM=Ti[o]||1,new an(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,n)}isZero(){return this.numerator.isZero()}};var Nu=V("Raydium_price");var un=class{constructor({decimals:t,symbol:n="UNKNOWN",name:o="UNKNOWN"}){this.decimals=t,this.symbol=n,this.name=o}equals(t){return this===t}},It=un;It.SOL=new un(kt);var go=_(require("bn.js"));var Du=new Q(new go.default(100));var qe=new se.default(0),Bi=new se.default(1),rc=new se.default(2),ic=new se.default(3),sc=new se.default(5),xi=new se.default(10),ac=new se.default(100),uc=new se.default(1e3),cc=new se.default(1e4),Ao=9007199254740991;function ie(e){let t=V("Raydium_parseBigNumberish");if(e instanceof se.default)return e;if(typeof e=="string"){if(e.match(/^-?[0-9]+$/))return new se.default(e);t.logWithError(`invalid BigNumberish string: ${e}`)}return typeof e=="number"?(e%1&&t.logWithError(`BigNumberish number underflow: ${e}`),(e>=Ao||e<=-Ao)&&t.logWithError(`BigNumberish number overflow: ${e}`),new se.default(String(e))):typeof e=="bigint"?new se.default(e.toString()):(t.error(`invalid BigNumberish value: ${e}`),new se.default(0))}var Pc=V("Raydium_amount"),kc=$e(wo.default);async function Po(e){new Promise(t=>setTimeout(t,e))}var U=require("@solana/web3.js"),Bo=_(require("axios"));var ae={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut"};var oe=require("@solana/web3.js"),ho=require("@solana/spl-token");var ko=V("Raydium_txUtil"),To=1644;function xt(e){let t=[],n=[];return e.microLamports&&(t.push(oe.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.microLamports})),n.push(ae.SetComputeUnitPrice)),e.units&&(t.push(oe.ComputeBudgetProgram.setComputeUnitLimit({units:e.units})),n.push(ae.SetComputeUnitLimit)),{instructions:t,instructionTypes:n}}async function Ge(e,t){var o,r;let n=t!=null?t:"confirmed";try{return((r=await((o=e.getLatestBlockhash)==null?void 0:o.call(e,{commitment:n})))==null?void 0:r.blockhash)||(await e.getRecentBlockhash(n)).blockhash}catch{return(await e.getRecentBlockhash(n)).blockhash}}function cn(e,t){e.length<1&&ko.logWithError(`no instructions provided: ${e.toString()}`),t.length<1&&ko.logWithError(`no signers provided:, ${t.toString()}`);let n=new oe.Transaction;n.recentBlockhash="11111111111111111111111111111111",n.feePayer=t[0],n.add(...e);try{return Buffer.from(n.serialize({verifySignatures:!1})).toString("base64").length<To}catch{return!1}}function he(e,t){let[n,o]=oe.PublicKey.findProgramAddressSync(e,t);return{publicKey:n,nonce:o}}function ot({instructions:e,payer:t,signers:n}){return cn(e,[t,...n])}function rt({instructions:e,payer:t,lookupTableAddressAccount:n,recentBlockhash:o=oe.Keypair.generate().publicKey.toString()}){let i=new oe.TransactionMessage({payerKey:t,recentBlockhash:o,instructions:e}).compileToV0Message(Object.values(n!=null?n:{}));try{return Buffer.from(new oe.VersionedTransaction(i).serialize()).toString("base64").length<To}catch{return!1}}var Ri=e=>Buffer.isBuffer(e)?e:e instanceof Uint8Array?Buffer.from(e.buffer,e.byteOffset,e.byteLength):Buffer.from(e);function ve(e){let t=[];return e.forEach(n=>{n instanceof oe.Transaction&&(n.recentBlockhash||(n.recentBlockhash=ho.TOKEN_PROGRAM_ID.toBase58()),n.feePayer||(n.feePayer=oe.Keypair.generate().publicKey));let o=n.serialize({requireAllSignatures:!1,verifySignatures:!1});n instanceof oe.VersionedTransaction&&(o=Ri(o));let r=o.toString("base64");t.push(r)}),console.log("simulate tx string:",t),t}var Re=require("@solana/web3.js");var Io=require("@solana/web3.js"),St=require("@solana/spl-token");var ln=V("Raydium_accountInfo_util");async function Xe(e,t,n){let{batchRequest:o,commitment:r="confirmed",chunkCount:i=100}=M({batchRequest:!1},n),s=mn(t,i),a=new Array(s.length).fill([]);if(o){let u=s.map(d=>{let p=e._buildArgs([d.map(b=>b.toBase58())],r,"base64");return{methodName:"getMultipleAccounts",args:p}}),l=mn(u,10);a=(await(await Promise.all(l.map(async d=>await e._rpcBatchRequest(d)))).flat()).map(d=>(d.error&&ln.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${d.error.message}`),d.result.value.map(p=>{if(p){let{data:b,executable:T,lamports:w,owner:S,rentEpoch:I}=p;return b.length!==2&&b[1]!=="base64"&&ln.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(b[0],"base64"),executable:T,lamports:w,owner:new Io.PublicKey(S),rentEpoch:I}}return null})))}else try{a=await Promise.all(s.map(u=>e.getMultipleAccountsInfo(u,r)))}catch(u){u instanceof Error&&ln.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${u.message}`)}return a.flat()}async function dn({connection:e,address:t}){let n=await Xe(e,[...new Set(t.map(r=>r.toString()))].map(r=>new Re.PublicKey(r))),o={};for(let r=0;r<t.length;r++){let i=n[r],s=t[r];if(!i)continue;let a=new Re.AddressLookupTableAccount({key:s,state:Re.AddressLookupTableAccount.deserialize(i.data)});o[s.toString()]=a,Kt[s.toString()]=a}return o}var Kt={"2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17":new Re.AddressLookupTableAccount({key:new Re.PublicKey("2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17"),state:Re.AddressLookupTableAccount.deserialize(Buffer.from("AQAAAP//////////d49+DAAAAAAAAQZMWvw7GUNJdaccNBVnb57OKakxL2BHLYvhRwVILRsgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMGRm/lIRcy/+ytunLDm+e8jOW7xfcSayxDmzpAAAAABt324ddloZPZy+FGzut5rBy0he1fWzeROoz1hX7/AKkG3fbh7nWP3hhCXbzkbM3athr8TYO5DSf+vfko2KGL/AVKU1D4XciC1hSlVnJ4iilt3x6rq9CmBniISTL07vagBqfVFxksXFEhjMlMPUrxf1ja7gibof1E49vZigAAAAAGp9UXGMd0yShWY5hpHV62i164o5tLbVxzVVshAAAAAIyXJY9OJInxuz0QKRSODYMLWhOZ2v8QhASOe9jb6fhZC3BlsePRfEU4nVJ/awTDzVi4bHMaoP21SbbRvAP4KUbIScv+6Yw2LHF/6K0ZjUPibbSWXCirYPGuuVl7zT789IUPLW4CpHr4JNCatp3ELXDLKMv6JJ+37le50lbBJ2LvDQdRqCgtphMF/imcN7mY5YRx2xE1A3MQ+L4QRaYK9u4GRfZP3LsAd00a+IkCpA22UNQMKdq5BFbJuwuOLqc8zxCTDlqxBG8J0HcxtfogQHDK06ukzfaXiNDKAob1MqBHS9lJxDYCwz8gd5DtFqNSTKG5l1zxIaKpDP/sffi2is1H9aKveyXSu5StXElYRl9SD5As0DHE4N0GLnf84/siiKXVyp4Ez121kLcUui/jLLFZEz/BwZK3Ilf9B9OcsEAeDMKAy2vjGSxQODgBz0QwGA+eP4ZjIjrIAQaXENv31QfLlOdXSRCkaybRniDHF4C8YcwhcvsqrOVuTP4B2Na+9wLdtrB31uz2rtlFI5kahdsnp/d1SrASDInYCtTYtdoke4kX+hoKWcEWM4Tle8pTUkUVv4BxS6fje/EzKBE4Qu9N9LMnrw/JNO0hqMVB4rk/2ou4AB1loQ7FZoPwut2o4KZB+0p9xnbrQKw038qjpHar+PyDwvxBRcu5hpHw3dguezeWv+IwvgW5icu8EGkhGa9AkFPPJT7VMSFb8xowveU=","base64"))})};var Ct=class{constructor(t){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=t.connection,this.feePayer=t.feePayer,this.signAllTransactions=t.signAllTransactions,this.owner=t.owner,this.cluster=t.cluster,this.blockhashCommitment=t.blockhashCommitment,this.api=t.api}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var o;let t=(await Bo.default.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:n}=(o=t==null?void 0:t[15])!=null?o:{};if(!!n)return{units:6e5,microLamports:Math.min(Math.ceil(n*1e6/6e5),25e3)}}addCustomComputeBudget(t){if(t){let{instructions:n,instructionTypes:o}=xt(t);return this.instructions.unshift(...n),this.instructionTypes.unshift(...o),!0}return!1}async calComputeBudget({config:t,defaultIns:n}){try{let o=t||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(o))return;n&&this.instructions.unshift(...n)}catch{n&&this.instructions.unshift(...n)}}addInstruction({instructions:t=[],endInstructions:n=[],signers:o=[],instructionTypes:r=[],endInstructionTypes:i=[],lookupTableAddress:s=[]}){return this.instructions.push(...t),this.endInstructions.push(...n),this.signers.push(...o),this.instructionTypes.push(...r),this.endInstructionTypes.push(...i),this.lookupTableAddress.push(...s.filter(a=>a!==U.PublicKey.default.toString())),this}async versionBuild({txVersion:t,extInfo:n}){return t===0?await this.buildV0(M({},n||{})):this.build(n)}build(t){var o;let n=new U.Transaction;return this.allInstructions.length&&n.add(...this.allInstructions),n.feePayer=this.feePayer,((o=this.owner)==null?void 0:o.signer)&&!this.signers.some(r=>r.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:n,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async r=>{var l;let{recentBlockHash:i,skipPreflight:s=!0,sendAndConfirm:a}=r||{},u=i!=null?i:await Ge(this.connection,this.blockhashCommitment);if(n.recentBlockhash=u,this.signers.length&&n.sign(...this.signers),ve([n]),(l=this.owner)!=null&&l.isKeyPair)return{txId:a?await(0,U.sendAndConfirmTransaction)(this.connection,n,this.signers.find(d=>d.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:s}):await this.connection.sendRawTransaction(n.serialize(),{skipPreflight:s}),signedTx:n};if(this.signAllTransactions){let m=await this.signAllTransactions([n]);return{txId:await this.connection.sendRawTransaction(m[0].serialize(),{skipPreflight:s}),signedTx:m[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:t||{}}}buildMultiTx(t){var l;let{extraPreBuildData:n=[],extInfo:o}=t,{transaction:r}=this.build(o),i=n.filter(m=>m.transaction.instructions.length>0),s=[r,...i.map(m=>m.transaction)],a=[this.signers,...i.map(m=>m.signers)],u=[...this.instructionTypes,...i.map(m=>m.instructionTypes).flat()];return(l=this.owner)!=null&&l.signer&&a.forEach(m=>{m.some(d=>d.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:s,signers:a,instructionTypes:u,execute:async m=>{var S;let{sequentially:d,onTxUpdate:p,recentBlockHash:b,skipPreflight:T=!0}=m||{},w=b!=null?b:await Ge(this.connection,this.blockhashCommitment);if((S=this.owner)!=null&&S.isKeyPair){if(d){let I=[];for(let k of s){let A=await(0,U.sendAndConfirmTransaction)(this.connection,k,this.signers.find(P=>P.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:T});I.push(A)}return{txIds:I,signedTxs:s}}return{txIds:await await Promise.all(s.map(async I=>(I.recentBlockhash=w,await this.connection.sendRawTransaction(I.serialize(),{skipPreflight:T})))),signedTxs:s}}if(this.signAllTransactions){let I=s.map((A,P)=>(A.recentBlockhash=w,a[P].length&&A.sign(...a[P]),A));ve(I);let k=await this.signAllTransactions(I);if(d){let A=0,P=[],E=async()=>{if(!k[A])return;let L=await this.connection.sendRawTransaction(k[A].serialize(),{skipPreflight:T});P.push({txId:L,status:"sent",signedTx:k[A]}),p==null||p([...P]),A++,this.connection.onSignature(L,Y=>{let v=P.findIndex(z=>z.txId===L);v>-1&&(P[v].status=Y.err?"error":"success"),p==null||p([...P]),Y.err||E()},"processed"),this.connection.getSignatureStatus(L)};return await E(),{txIds:P.map(L=>L.txId),signedTxs:k}}else{let A=[];for(let P=0;P<k.length;P+=1){let E=await this.connection.sendRawTransaction(k[P].serialize(),{skipPreflight:T});A.push(E)}return{txIds:A,signedTxs:k}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:o||{}}}async versionMultiBuild({extraPreBuildData:t,txVersion:n,extInfo:o}){return n===0?await this.buildV0MultiTx({extraPreBuildData:t,buildProps:o||{}}):this.buildMultiTx({extraPreBuildData:t,extInfo:o})}async buildV0(t){var b;let p=t||{},{lookupTableCache:n={},lookupTableAddress:o=[],forerunCreate:r}=p,i=be(p,["lookupTableCache","lookupTableAddress","forerunCreate"]),s=M(M({},this.cluster==="devnet"?{}:Kt),n),a=Array.from(new Set([...o,...this.lookupTableAddress])),u=[];for(let T of a)s[T]===void 0&&u.push(new U.PublicKey(T));let l=await dn({connection:this.connection,address:u});for(let[T,w]of Object.entries(l))s[T]=w;let m=new U.TransactionMessage({payerKey:this.feePayer,recentBlockhash:r?U.PublicKey.default.toBase58():await Ge(this.connection,this.blockhashCommitment),instructions:[...this.allInstructions]}).compileToV0Message(Object.values(s));((b=this.owner)==null?void 0:b.signer)&&!this.signers.some(T=>T.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let d=new U.VersionedTransaction(m);return d.sign(this.signers),{builder:this,transaction:d,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async T=>{var k;let{recentBlockHash:w,skipPreflight:S=!0,sendAndConfirm:I}=T||{};if(w&&(d.message.recentBlockhash=w),ve([d]),(k=this.owner)!=null&&k.isKeyPair){let A=await this.connection.sendTransaction(d,{skipPreflight:S});if(I){let{lastValidBlockHeight:P,blockhash:E}=await this.connection.getLatestBlockhash({commitment:this.blockhashCommitment});await this.connection.confirmTransaction({blockhash:E,lastValidBlockHeight:P,signature:A},"confirmed")}return{txId:A,signedTx:d}}if(this.signAllTransactions){let A=await this.signAllTransactions([d]);return{txId:await this.connection.sendTransaction(A[0],{skipPreflight:S}),signedTx:A[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:i||{}}}async buildV0MultiTx(t){var l;let{extraPreBuildData:n=[],buildProps:o}=t,{transaction:r}=await this.buildV0(o),i=n.filter(m=>m.builder.instructions.length>0),s=[r,...i.map(m=>m.transaction)],a=[this.signers,...i.map(m=>m.signers)],u=[...this.instructionTypes,...i.map(m=>m.instructionTypes).flat()];return(l=this.owner)!=null&&l.signer&&a.forEach(m=>{m.some(d=>d.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),s.forEach(async(m,d)=>{m.sign(a[d])}),{builder:this,transactions:s,signers:a,instructionTypes:u,buildProps:o,execute:async m=>{var w;let{sequentially:d,onTxUpdate:p,recentBlockHash:b,skipPreflight:T=!0}=m||{};if(b&&s.forEach(S=>S.message.recentBlockhash=b),ve(s),(w=this.owner)!=null&&w.isKeyPair){if(d){let S=[];for(let I of s){let k=await this.connection.sendTransaction(I,{skipPreflight:T}),{lastValidBlockHeight:A,blockhash:P}=await this.connection.getLatestBlockhash({commitment:this.blockhashCommitment});await this.connection.confirmTransaction({blockhash:P,lastValidBlockHeight:A,signature:k},"confirmed"),S.push(k)}return{txIds:S,signedTxs:s}}return{txIds:await Promise.all(s.map(async S=>await this.connection.sendTransaction(S,{skipPreflight:T}))),signedTxs:s}}if(this.signAllTransactions){let S=await this.signAllTransactions(s);if(d){let I=0,k=[],A=async()=>{if(!S[I])return;let P=await this.connection.sendTransaction(S[I],{skipPreflight:T});k.push({txId:P,status:"sent",signedTx:S[I]}),p==null||p([...k]),I++,this.connection.onSignature(P,E=>{let L=k.findIndex(Y=>Y.txId===P);L>-1&&(k[L].status=E.err?"error":"success"),p==null||p([...k]),E.err||A()},"processed"),this.connection.getSignatureStatus(P)};return A(),{txIds:[],signedTxs:S}}else{let I=[];for(let k=0;k<S.length;k+=1){let A=await this.connection.sendTransaction(S[k],{skipPreflight:T});I.push(A)}return{txIds:I,signedTxs:S}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:o||{}}}async sizeCheckBuild(t){var m;let l=t||{},{computeBudgetConfig:n}=l,o=be(l,["computeBudgetConfig"]),r=n?xt(n):{instructions:[],instructionTypes:[]},i=this.signers.reduce((d,p)=>W(M({},d),{[p.publicKey.toBase58()]:p}),{}),s=[],a=[],u=[];if(this.allInstructions.forEach(d=>{let p=[...u,d],b=n?[...r.instructions,...p]:p,w=[...new Set(p.map(S=>S.keys.filter(I=>I.isSigner).map(I=>I.pubkey.toString())).flat()).values()].map(S=>new U.PublicKey(S));if(u.length<12&&ot({instructions:b,payer:this.feePayer,signers:w})||ot({instructions:p,payer:this.feePayer,signers:w}))u.push(d);else{if(u.length===0)throw Error("item ins too big");ot({instructions:n?[...r.instructions,...u]:[...u],payer:this.feePayer,signers:w})?s.push(new U.Transaction().add(...r.instructions,...u)):s.push(new U.Transaction().add(...u)),a.push(Array.from(new Set(u.map(S=>S.keys.filter(I=>I.isSigner).map(I=>I.pubkey.toString())).flat())).map(S=>i[S]).filter(S=>S!==void 0)),u=[d]}}),u.length>0){let p=[...new Set(u.map(b=>b.keys.filter(T=>T.isSigner).map(T=>T.pubkey.toString())).flat()).values()].map(b=>i[b]).filter(b=>b!==void 0);ot({instructions:n?[...r.instructions,...u]:[...u],payer:this.feePayer,signers:p.map(b=>b.publicKey)})?s.push(new U.Transaction().add(...r.instructions,...u)):s.push(new U.Transaction().add(...u)),a.push(p)}return s.forEach(d=>d.feePayer=this.feePayer),(m=this.owner)!=null&&m.signer&&a.forEach(d=>{d.some(p=>p.publicKey.equals(this.owner.publicKey))||d.push(this.owner.signer)}),{builder:this,transactions:s,signers:a,instructionTypes:this.instructionTypes,execute:async d=>{var I;let{sequentially:p,onTxUpdate:b,recentBlockHash:T,skipPreflight:w=!0}=d||{},S=T!=null?T:await Ge(this.connection,this.blockhashCommitment);if(s.forEach(async(k,A)=>{k.recentBlockhash=S,a[A].length&&k.sign(...a[A])}),ve(s),(I=this.owner)!=null&&I.isKeyPair){if(p){let k=[];for(let A of s){let P=await(0,U.sendAndConfirmTransaction)(this.connection,A,this.signers.find(E=>E.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:w});k.push(P)}return{txIds:k,signedTxs:s}}return{txIds:await Promise.all(s.map(async k=>await this.connection.sendRawTransaction(k.serialize(),{skipPreflight:w}))),signedTxs:s}}if(this.signAllTransactions){let k=await this.signAllTransactions(s);if(p){let A=0,P=[],E=async()=>{if(!k[A])return;let L=await this.connection.sendRawTransaction(k[A].serialize(),{skipPreflight:w});P.push({txId:L,status:"sent",signedTx:k[A]}),b==null||b([...P]),A++,this.connection.onSignature(L,Y=>{let v=P.findIndex(z=>z.txId===L);v>-1&&(P[v].status=Y.err?"error":"success"),b==null||b([...P]),Y.err||E()},"processed"),this.connection.getSignatureStatus(L)};return await E(),{txIds:P.map(L=>L.txId),signedTxs:k}}else{let A=[];for(let P=0;P<k.length;P+=1){let E=await this.connection.sendRawTransaction(k[P].serialize(),{skipPreflight:w});A.push(E)}return{txIds:A,signedTxs:k}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:o||{}}}async sizeCheckBuildV0(t){var I;let S=t||{},{computeBudgetConfig:n,lookupTableCache:o={},lookupTableAddress:r=[]}=S,i=be(S,["computeBudgetConfig","lookupTableCache","lookupTableAddress"]),s=M(M({},this.cluster==="devnet"?{}:Kt),o),a=Array.from(new Set([...this.lookupTableAddress,...r])),u=[];for(let k of a)s[k]===void 0&&u.push(new U.PublicKey(k));let l=await dn({connection:this.connection,address:u});for(let[k,A]of Object.entries(l))s[k]=A;let m=n?xt(n):{instructions:[],instructionTypes:[]},d=await Ge(this.connection,this.blockhashCommitment),p=this.signers.reduce((k,A)=>W(M({},k),{[A.publicKey.toBase58()]:A}),{}),b=[],T=[],w=[];if(this.allInstructions.forEach(k=>{let A=[...w,k],P=n?[...m.instructions,...A]:A;if(w.length<12&&rt({instructions:P,payer:this.feePayer,lookupTableAddressAccount:s})||rt({instructions:A,payer:this.feePayer,lookupTableAddressAccount:s}))w.push(k);else{if(w.length===0)throw Error("item ins too big");let E={};for(let L of[...new Set(a)])s[L]!==void 0&&(E[L]=s[L]);if(n&&rt({instructions:[...m.instructions,...w],payer:this.feePayer,lookupTableAddressAccount:s,recentBlockhash:d})){let L=new U.TransactionMessage({payerKey:this.feePayer,recentBlockhash:d,instructions:[...m.instructions,...w]}).compileToV0Message(Object.values(s));b.push(new U.VersionedTransaction(L))}else{let L=new U.TransactionMessage({payerKey:this.feePayer,recentBlockhash:d,instructions:[...w]}).compileToV0Message(Object.values(s));b.push(new U.VersionedTransaction(L))}T.push(Array.from(new Set(w.map(L=>L.keys.filter(Y=>Y.isSigner).map(Y=>Y.pubkey.toString())).flat())).map(L=>p[L]).filter(L=>L!==void 0)),w=[k]}}),w.length>0){let A=[...new Set(w.map(P=>P.keys.filter(E=>E.isSigner).map(E=>E.pubkey.toString())).flat()).values()].map(P=>p[P]).filter(P=>P!==void 0);if(n&&rt({instructions:[...m.instructions,...w],payer:this.feePayer,lookupTableAddressAccount:s,recentBlockhash:d})){let P=new U.TransactionMessage({payerKey:this.feePayer,recentBlockhash:d,instructions:[...m.instructions,...w]}).compileToV0Message(Object.values(s));b.push(new U.VersionedTransaction(P))}else{let P=new U.TransactionMessage({payerKey:this.feePayer,recentBlockhash:d,instructions:[...w]}).compileToV0Message(Object.values(s));b.push(new U.VersionedTransaction(P))}T.push(A)}return(I=this.owner)!=null&&I.signer&&T.forEach(k=>{k.some(A=>A.publicKey.equals(this.owner.publicKey))||k.push(this.owner.signer)}),{builder:this,transactions:b,buildProps:t,signers:T,instructionTypes:this.instructionTypes,execute:async k=>{var Y;let{sequentially:A,onTxUpdate:P,recentBlockHash:E,skipPreflight:L=!0}=k||{};if(b.map(async(v,z)=>{T[z].length&&v.sign(T[z]),E&&(v.message.recentBlockhash=E)}),ve(b),(Y=this.owner)!=null&&Y.isKeyPair){if(A){let v=[];for(let z of b){let ee=await this.connection.sendTransaction(z,{skipPreflight:L}),{lastValidBlockHeight:Z,blockhash:de}=await this.connection.getLatestBlockhash({commitment:this.blockhashCommitment});await this.connection.confirmTransaction({blockhash:de,lastValidBlockHeight:Z,signature:ee},"confirmed"),v.push(ee)}return{txIds:v,signedTxs:b}}return{txIds:await Promise.all(b.map(async v=>await this.connection.sendTransaction(v,{skipPreflight:L}))),signedTxs:b}}if(this.signAllTransactions){let v=await this.signAllTransactions(b);if(A){let z=0,ee=[],Z=async()=>{if(!v[z])return;let de=await this.connection.sendTransaction(v[z],{skipPreflight:L});ee.push({txId:de,status:"sent",signedTx:v[z]}),P==null||P([...ee]),z++,this.connection.onSignature(de,Oe=>{let Fe=ee.findIndex(J=>J.txId===de);Fe>-1&&(ee[Fe].status=Oe.err?"error":"success"),P==null||P([...ee]),Oe.err||Z()},"processed"),this.connection.getSignatureStatus(de)};return Z(),{txIds:[],signedTxs:v}}else{let z=[];for(let ee=0;ee<v.length;ee+=1){let Z=await this.connection.sendTransaction(v[ee],{skipPreflight:L});z.push(Z)}return{txIds:z,signedTxs:v}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:i||{}}}};function mn(e,t=1,n=[]){let o=[...e];if(t<=0)return n;for(;o.length;)n.push(o.splice(0,t));return n}var F=require("@solana/web3.js"),xo=new F.PublicKey("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),So=new F.PublicKey("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),pn=new F.PublicKey("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),ll=new F.PublicKey("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),ml=new F.PublicKey("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),Ko=new F.PublicKey("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Li=new F.PublicKey("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),dl=new F.PublicKey("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),Oi=new F.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Ni=new F.PublicKey("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),pl=new F.PublicKey("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),fl=new F.PublicKey("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),Mi=new F.PublicKey("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),vi=new F.PublicKey("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),_i=new F.PublicKey("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Vi=new F.PublicKey("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),Fi=new F.PublicKey("8yQvrjQuritLntxz6pAaWcEX6CsRMeDmr7baCLnNwEuw"),yl=new F.PublicKey("E1oP2yNZXw3dFnUoPygWZPg9u2Gad87VFVPeYWqa6rD6"),bl=new F.PublicKey("E1oP2yNZXw3dFnUoPygWZPg9u2Gad87VFVPeYWqa6rD6"),Ei=new F.PublicKey("CPMDWBwJDtYax9qW7AyRuVC19Cc4L4Vcy4n2BHAbHkCW"),Di=new F.PublicKey("7rQ1QFNosMkUCuh7Z7fPbTHvh73b68sQYdirycEzJVuw"),Wi=new F.PublicKey("G11FKBRaAkHAKuLCgLM6K6NUc9rTjPAznRCjZifrTQe2"),st={IDO_PROGRAM_ID_V1:Mi,IDO_PROGRAM_ID_V2:vi,IDO_PROGRAM_ID_V3:_i,IDO_PROGRAM_ID_V4:Vi};var gl={SERUM_MARKET:F.PublicKey.default,OPENBOOK_MARKET:new F.PublicKey("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),UTIL1216:F.PublicKey.default,FarmV3:new F.PublicKey("85BFyr98MbCUU9MVTEgzx1nbhWACbJqLzho6zd6DZcWL"),FarmV5:new F.PublicKey("EcLzTrNg9V7qhcdyXDe2qjtPkiGzDM2UbdRaeaadU5r2"),FarmV6:new F.PublicKey("Farm2hJLcqPtPg8M4rR6DMrsRNc5TPm5Cs4bVQrMe2T7"),AmmV4:new F.PublicKey("HWy1jotHpo6UqeQxx49dpYYdQB8wj9Qk9MdxwjLvDHB8"),AmmStable:new F.PublicKey("DDg4VmQaJV9ogWce7LpcjBA9bv22wRp5uaTPa5pGjijF"),CLMM:new F.PublicKey("devi51mZmdwUJGU9hjN27vEz64Gps7uUefqxg27EAtH"),Router:new F.PublicKey("BVChZ3XFEwTMUk1o9i3HAf91H6mFxSwa5X2wFAWhYPhU"),CREATE_CPMM_POOL_PROGRAM:Ei,CREATE_CPMM_POOL_AUTH:Di,CREATE_CPMM_POOL_FEE_ACC:Wi,FEE_DESTINATION_ID:new F.PublicKey("3XMrhbv989VxAMi3DErLV9eJht1pHppW5LbKxe9fkEFR")};var qi=require("@solana/web3.js");var Ui=require("@solana/spl-token");var Gi=_(require("bn.js"));var H={BASE_HOST:"https://api-v3.raydium.io",OWNER_BASE_HOST:"https://owner-v1.raydium.io",SERVICE_BASE_HOST:"https://service.raydium.io",SEND_TRANSACTION:"/send-transaction",FARM_ARP:"/main/farm/info",FARM_ARP_LINE:"/main/farm-apr-tv",CLMM_CONFIG:"/main/clmm-config",VERSION:"/main/version",CHECK_AVAILABILITY:"/v3/main/AvailabilityCheckAPI",RPCS:"/main/rpcs",INFO:"/main/info",STAKE_POOLS:"/main/stake-pools",CHAIN_TIME:"/main/chain-time",TOKEN_LIST:"/mint/list",MINT_INFO_ID:"/mint/ids",JUP_TOKEN_LIST:"https://tokens.jup.ag/tokens?tags=lst,community",POOL_LIST:"/pools/info/list",POOL_SEARCH_BY_ID:"/pools/info/ids",POOL_SEARCH_MINT:"/pools/info/mint",POOL_SEARCH_LP:"/pools/info/lps",POOL_KEY_BY_ID:"/pools/key/ids",POOL_LIQUIDITY_LINE:"/pools/line/liquidity",POOL_POSITION_LINE:"/pools/line/position",FARM_INFO:"/farms/info/ids",FARM_LP_INFO:"/farms/info/lp",FARM_KEYS:"/farms/key/ids",OWNER_CREATED_FARM:"/create-pool/{owner}",OWNER_IDO:"/main/ido/{owner}",OWNER_STAKE_FARMS:"/position/stake/{owner}",IDO_KEYS:"/ido/key/ids",SWAP_HOST:"https://transaction-v1.raydium.io",SWAP_COMPUTE:"/compute/",SWAP_TX:"/transaction/",MINT_PRICE:"/mint/price",MIGRATE_CONFIG:"/main/migrate-lp",PRIORITY_FEE:"/main/auto-fee",JITO:"https://mainnet.block-engine.jito.wtf",JITO_TRANSACTION:"/api/v1/transactions",JITO_BUNDLE:"/api/v1/bundles"},Dl=M({},H);var Co="ray_tab_hash",fn="ray_req_hash",Xi=()=>{if(typeof window===void 0)return"";let e=sessionStorage.getItem(Co);return e||(e=`ray-${Date.now()}`,sessionStorage.setItem(Co,e)),e},Rt=async o=>{var r=o,{logCount:e=1e3,removeLastLog:t}=r,n=be(r,["logCount","removeLastLog"]);if(typeof window===void 0)return new Promise(s=>s());let i=JSON.parse(localStorage.getItem(fn)||"[]").slice(0,e-1);t&&i.pop(),new Blob([JSON.stringify(n.data)]).size>1024&&(n.data=JSON.stringify(n.data).substring(0,200)+"..."),i.unshift(W(M({},n),{time:Date.now(),session:Xi()}));try{localStorage.setItem(fn,JSON.stringify(i))}catch{if(t){let s=!1,a=JSON.stringify(n.data).substring(0,100);for(i[0].data=a+(a.length>100?"...":"");!s;){i.pop();let u=JSON.stringify(n.data).substring(0,100);i[0].data=u+(u.length>100?"...":"");try{localStorage.setItem(fn,JSON.stringify(i)),s=!0}catch{s=!1}}return new Promise(u=>u())}return Rt(W(M({},n),{logCount:e,removeLastLog:!0}))}};var mt=require("@solana/web3.js");var Za=require("lodash");var Vt=require("@solana/spl-token"),Do=require("@solana/web3.js");var yn=(...e)=>e.map(t=>{try{return typeof t=="object"?JSON.stringify(t):t}catch{return t}}).join(", "),ce=class{constructor({scope:t,moduleName:n}){this.disabled=!1;this.scope=t,this.logger=V(n)}createTxBuilder(t){return this.scope.checkOwner(),new Ct({connection:this.scope.connection,feePayer:t||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...t){this.logger.debug(yn(t))}logInfo(...t){this.logger.info(yn(t))}logAndCreateError(...t){let n=yn(t);throw new Error(n)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};var _t=require("@solana/spl-token"),Fo=require("@solana/web3.js"),Hi=_(require("bn.js"));var Vo=require("@solana/web3.js"),Yi=require("@solana/spl-token"),ji=_(require("bn.js"));var Mo=require("@solana/web3.js"),ze=_(require("bn.js"));var K=require("@solana/buffer-layout"),Lt=K.Layout,Ro=K.Structure;var bn=K.UInt;var Lo=K.u8,Te=K.u16;var gn=K.u32;var Oo=K.nu64;var Ie=K.s32;var No=K.seq;var q=K.blob;var An=K.bits;var _e=class extends Lt{constructor(n,o,r){super(n,r);this.blob=q(n),this.signed=o}decode(n,o=0){let r=new ze.default(this.blob.decode(n,o),10,"le");return this.signed?r.fromTwos(this.span*8).clone():r}encode(n,o,r=0){return typeof n=="number"&&(n=new ze.default(n)),this.signed&&(n=n.toTwos(this.span*8)),this.blob.encode(n.toArrayLike(Buffer,"le",this.span),o,r)}},Ot=class extends Lt{constructor(n){super(8,n);this._lower=An(gn(),!1),this._upper=An(gn(),!1)}addBoolean(n){this._lower.fields.length<32?this._lower.addBoolean(n):this._upper.addBoolean(n)}decode(n,o=0){let r=this._lower.decode(n,o),i=this._upper.decode(n,o+this._lower.span);return M(M({},r),i)}encode(n,o,r=0){return this._lower.encode(n,o,r)+this._upper.encode(n,o,r+this._lower.span)}};function B(e){return new bn(1,e)}function le(e){return new bn(4,e)}function c(e){return new _e(8,!1,e)}function O(e){return new _e(16,!1,e)}function vo(e){return new _e(1,!0,e)}function Mt(e){return new _e(8,!0,e)}function _o(e){return new _e(16,!0,e)}var Nt=class extends Lt{constructor(n,o,r,i){super(n.span,i);this.layout=n,this.decoder=o,this.encoder=r}decode(n,o){return this.decoder(this.layout.decode(n,o))}encode(n,o,r){return this.layout.encode(this.encoder(n),o,r)}getSpan(n,o){return this.layout.getSpan(n,o)}};function f(e){return new Nt(q(32),t=>new Mo.PublicKey(t),t=>t.toBuffer(),e)}function Be(e){return new Nt(Lo(),zi,Qi,e)}function zi(e){if(e===0)return!1;if(e===1)return!0;throw new Error("Invalid bool: "+e)}function Qi(e){return e?1:0}var wn=class extends Ro{decode(t,n){return super.decode(t,n)}};function h(e,t,n){return new wn(e,t,n)}function x(e,t,n){let o,r=typeof t=="number"?t:(0,ze.isBN)(t)?t.toNumber():new Proxy(t,{get(i,s){if(!o){let a=Reflect.get(i,"count");o=(0,ze.isBN)(a)?a.toNumber():a,Reflect.set(i,"count",o)}return Reflect.get(i,s)},set(i,s,a){return s==="count"&&(o=a),Reflect.set(i,s,a)}});return No(e,r,n)}var Pn=h([f("mint"),f("owner"),c("amount"),le("delegateOption"),f("delegate"),B("state"),le("isNativeOption"),c("isNative"),c("delegatedAmount"),le("closeAuthorityOption"),f("closeAuthority")]);var fm=V("Raydium_Util");var Ks=require("@solana/spl-token"),Xo=require("@solana/web3.js");var kn=require("@solana/web3.js");var $i=h([B("instruction")]),es=h([B("instruction")]),ts=h([c("rewardState"),c("rewardOpenTime"),c("rewardEndTime"),c("rewardLastUpdateTime"),c("totalReward"),c("totalRewardEmissioned"),c("rewardClaimed"),c("rewardPerSecond"),O("accRewardPerShare"),f("rewardVault"),f("rewardMint"),f("rewardSender"),c("rewardType"),x(c(),15,"padding")]),ns=h([c("state"),c("nonce"),f("lpVault"),f("rewardVault"),f(),f(),c(),c(),c("totalReward"),O("perShareReward"),c("lastSlot"),c("perSlotReward")]),os=h([c("state"),c("nonce"),f("lpVault"),f("rewardVaultA"),c("totalRewardA"),O("perShareRewardA"),c("perSlotRewardA"),B("option"),f("rewardVaultB"),q(7),c("totalRewardB"),O("perShareRewardB"),c("perSlotRewardB"),c("lastSlot"),f()]),rs=h([c(),c("state"),c("nonce"),c("validRewardTokenNum"),O("rewardMultiplier"),c("rewardPeriodMax"),c("rewardPeriodMin"),c("rewardPeriodExtend"),f("lpMint"),f("lpVault"),x(ts,5,"rewardInfos"),f("creator"),f(),x(c(),32,"padding")]),is=new Proxy(ns,{get(e,t,n){return t==="decode"?(...o)=>{let r=e.decode(...o);return W(M({},r),{version:3,rewardInfos:[{rewardVault:r.rewardVault,totalReward:r.totalReward,perSlotReward:r.perSlotReward,perShareReward:r.perShareReward}]})}:Reflect.get(e,t,n)}}),ss=new Proxy(os,{get(e,t,n){return t==="decode"?(...o)=>{let r=e.decode(...o);return W(M({},r),{version:5,rewardInfos:[{rewardVault:r.rewardVaultA,totalReward:r.totalRewardA,perSlotReward:r.perSlotRewardA,perShareReward:r.perShareRewardA},{rewardVault:r.rewardVaultB,totalReward:r.totalRewardB,perSlotReward:r.perSlotRewardB,perShareReward:r.perShareRewardB}]})}:Reflect.get(e,t,n)}}),Wo=new Proxy(rs,{get(e,t,n){return t==="decode"?(...o)=>{let r=e.decode(...o);return W(M({},r),{version:6,rewardInfos:r.rewardInfos.map(i=>{var s;return W(M({},i),{rewardType:((s=Object.entries(at).find(a=>String(a[1])===i.rewardType.toString()))!=null?s:["Standard SPL"])[0]})})})}:Reflect.get(e,t,n)}}),as=h([c("isSet"),c("rewardPerSecond"),c("rewardOpenTime"),c("rewardEndTime"),c("rewardType")]),us=h([B("instruction"),c("nonce"),x(as,5,"rewardTimeInfo")]),cs=h([B("instruction"),c("rewardReopenTime"),c("rewardEndTime"),c("rewardPerSecond")]),ls=h([B("instruction"),c("isSet"),c("rewardPerSecond"),c("rewardOpenTime"),c("rewardEndTime"),c("rewardType")]),Um=h([c("state"),f("id"),f("owner"),c("deposited"),x(c(),1,"rewardDebts")]),qo=h([c("state"),f("id"),f("owner"),c("deposited"),x(O(),1,"rewardDebts"),c(""),c("voteLockedBalance"),x(c(),15)]),Gm=h([c("state"),f("id"),f("owner"),c("deposited"),x(c(),2,"rewardDebts")]),ms=h([c("state"),f("id"),f("owner"),c("deposited"),x(O(),2,"rewardDebts"),x(c(),17)]),ds=h([c(),c("state"),f("id"),f("owner"),c("deposited"),x(O(),5,"rewardDebts"),x(c(),16)]),ps=h([B("instruction"),c("amount")]),fs=h([f("mint"),f("grantAuthority"),c("baselineVoteWeightScaledFactor"),c("maxExtraLockupVoteWeightScaledFactor"),c("lockupSaturationSecs"),vo("digitShift"),x(B(),7,"reserved1"),x(c(),7,"reserved2")]),ys=h([q(8),f("governanceProgramId"),f("realm"),f("realmGoverningTokenMint"),f("realmAuthority"),x(B(),32,"reserved1"),x(fs,4,"votingMints"),Mt("timeOffset"),B("bump"),x(B(),7,"reserved2"),x(c(),11,"reserved3")]),bs=h([Mt("startTime"),Mt("endTime"),B("kind"),x(B(),15,"reserved")]),gs=h([x(bs,1,"lockup"),c("amountDeposited_native"),c("amountInitiallyLockedNative"),Be("isUsed"),Be("allowClawback"),B("votingMintConfigIdx"),x(B(),29,"reserved")]),As=h([q(8),f("voterAuthority"),f("registrar"),x(gs,32,"deposits"),B("voterBump"),B("voterWweightRecordBump"),x(B(),94,"reserved")]);var Zm=V("Raydium_farm_config"),ws=new kn.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Ps=new kn.PublicKey("FrspKwj8i3pNmKwXreTveC4fu7KL5ZbGeXdZBe2XViu1");var at={"Standard SPL":0,"Option tokens":1},Uo={[xo.toString()]:3,[So.toString()]:5,[pn.toString()]:6};var ct=require("@solana/web3.js"),hn=require("@solana/spl-token"),hs=_(require("bn.js"));var ks=_(require("bn.js"));var gd=V("Raydium.farm.util");var Fd=V("Raydium_farm_instruction"),Ed={voterStakeRegistryCreateVoter:Buffer.from([6,24,245,52,243,255,148,25]),voterStakeRegistryCreateDepositEntry:Buffer.from([185,131,167,186,159,125,19,67]),voterStakeRegistryDeposit:Buffer.from([242,35,198,137,82,225,242,182]),voterStakeRegistryWithdraw:Buffer.from([183,18,70,156,148,109,161,34]),voterStakeRegistryUpdateVoterWeightRecord:Buffer.from([45,185,3,36,109,190,115,169])};var Aa=require("@solana/web3.js"),Mn=require("@solana/spl-token");var wp=h([le("mintAuthorityOption"),f("mintAuthority"),c("supply"),B("decimals"),B("isInitialized"),le("freezeAuthorityOption"),f("freezeAuthority")]);var Cs=require("@solana/web3.js"),zo=require("@solana/spl-token");var jo=require("@solana/spl-token"),Et=require("@solana/web3.js");var Rs=h([B("instruction"),c("amountIn"),c("minAmountOut")]),Ls=h([B("instruction"),c("maxAmountIn"),c("amountOut")]),Fp=h([B("instruction"),B("nonce")]),Os=h([B("instruction"),B("nonce"),c("startTime")]),Qo=h([c("status"),c("nonce"),c("maxOrder"),c("depth"),c("baseDecimal"),c("quoteDecimal"),c("state"),c("resetFlag"),c("minSize"),c("volMaxCutRatio"),c("amountWaveRatio"),c("baseLotSize"),c("quoteLotSize"),c("minPriceMultiplier"),c("maxPriceMultiplier"),c("systemDecimalValue"),c("minSeparateNumerator"),c("minSeparateDenominator"),c("tradeFeeNumerator"),c("tradeFeeDenominator"),c("pnlNumerator"),c("pnlDenominator"),c("swapFeeNumerator"),c("swapFeeDenominator"),c("baseNeedTakePnl"),c("quoteNeedTakePnl"),c("quoteTotalPnl"),c("baseTotalPnl"),c("poolOpenTime"),c("punishPcAmount"),c("punishCoinAmount"),c("orderbookToInitTime"),O("swapBaseInAmount"),O("swapQuoteOutAmount"),c("swapBase2QuoteFee"),O("swapQuoteInAmount"),O("swapBaseOutAmount"),c("swapQuote2BaseFee"),f("baseVault"),f("quoteVault"),f("baseMint"),f("quoteMint"),f("lpMint"),f("openOrders"),f("marketId"),f("marketProgramId"),f("targetOrders"),f("withdrawQueue"),f("lpVault"),f("owner"),c("lpReserve"),x(c(),3,"padding")]),Ep=h([c("accountType"),c("status"),c("nonce"),c("maxOrder"),c("depth"),c("baseDecimal"),c("quoteDecimal"),c("state"),c("resetFlag"),c("minSize"),c("volMaxCutRatio"),c("amountWaveRatio"),c("baseLotSize"),c("quoteLotSize"),c("minPriceMultiplier"),c("maxPriceMultiplier"),c("systemDecimalsValue"),c("abortTradeFactor"),c("priceTickMultiplier"),c("priceTick"),c("minSeparateNumerator"),c("minSeparateDenominator"),c("tradeFeeNumerator"),c("tradeFeeDenominator"),c("pnlNumerator"),c("pnlDenominator"),c("swapFeeNumerator"),c("swapFeeDenominator"),c("baseNeedTakePnl"),c("quoteNeedTakePnl"),c("quoteTotalPnl"),c("baseTotalPnl"),c("poolOpenTime"),c("punishPcAmount"),c("punishCoinAmount"),c("orderbookToInitTime"),O("swapBaseInAmount"),O("swapQuoteOutAmount"),O("swapQuoteInAmount"),O("swapBaseOutAmount"),c("swapQuote2BaseFee"),c("swapBase2QuoteFee"),f("baseVault"),f("quoteVault"),f("baseMint"),f("quoteMint"),f("lpMint"),f("modelDataAccount"),f("openOrders"),f("marketId"),f("marketProgramId"),f("targetOrders"),f("owner"),x(c(),64,"padding")]),Ns=h([B("instruction"),c("baseAmountIn"),c("quoteAmountIn"),c("fixedSide")]),Ms=h([B("instruction"),c("amountIn")]);var vs=h([c("fee")]);var Yo=require("@solana/web3.js");var _s=new Yo.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Vs=5e4,Fs=h([c("x"),c("y"),c("price")]),Up=h([c("accountType"),c("status"),c("multiplier"),c("validDataCount"),x(Fs,Vs,"DataElement")]);var $p=V("Raydium_liquidity_instruction");var Ln=require("@solana/spl-token"),zt=require("@solana/web3.js"),aa=_(require("bn.js"));var Js=_(require("bn.js"));var af=Buffer.from("amm_config","utf8"),uf=Buffer.from("pool","utf8"),cf=Buffer.from("pool_vault","utf8"),lf=Buffer.from("pool_reward_vault","utf8"),mf=Buffer.from("position","utf8"),df=Buffer.from("tick_array","utf8"),pf=Buffer.from("operation","utf8"),ff=Buffer.from("pool_tick_array_bitmap_extension","utf8");var me=_(require("bn.js")),Ho=new me.default(0),Tn=new me.default(1),Zo=new me.default(-1),Dt=new me.default(1).shln(64),Jo=new me.default(1).shln(128),Es=Dt.sub(Tn);var Ds=Jo.subn(1),Qe=-443636,lt=-Qe,Wt=new me.default("4295048016"),qt=new me.default("79226673521066979257578248091"),Ws=new me.default("4295048017"),qs=new me.default("79226673521066979257578248090");var Us=new me.default(10).pow(new me.default(6));var bf=new me.default("18446744073700000000");var Zs=_(require("bn.js"));var Qs=require("@solana/web3.js"),Ys=_(require("bn.js"));var Bn=14;var Xs=_(require("bn.js"));var js=require("@solana/spl-token");var Gt=60;var $s=h([q(8),B("bump"),Te("index"),f(""),le("protocolFeeRate"),le("tradeFeeRate"),Te("tickSpacing"),x(c(),8,"")]),ea=h([le("blockTimestamp"),O("sqrtPriceX64"),O("cumulativeTimePriceX64"),x(O(),1,"")]),ta=h([q(8),Be("initialized"),f("poolId"),x(ea,1e3,"observations"),x(O(),5,"")]),na=h([B("rewardState"),c("openTime"),c("endTime"),c("lastUpdateTime"),O("emissionsPerSecondX64"),c("rewardTotalEmissioned"),c("rewardClaimed"),f("tokenMint"),f("tokenVault"),f("creator"),O("rewardGrowthGlobalX64")]),Cn=h([q(8),B("bump"),f("ammConfig"),f("creator"),f("mintA"),f("mintB"),f("vaultA"),f("vaultB"),f("observationId"),B("mintDecimalsA"),B("mintDecimalsB"),Te("tickSpacing"),O("liquidity"),O("sqrtPriceX64"),Ie("tickCurrent"),Te("observationIndex"),Te("observationUpdateDuration"),O("feeGrowthGlobalX64A"),O("feeGrowthGlobalX64B"),c("protocolFeesTokenA"),c("protocolFeesTokenB"),O("swapInAmountTokenA"),O("swapOutAmountTokenB"),O("swapInAmountTokenB"),O("swapOutAmountTokenA"),B("status"),x(B(),7,""),x(na,3,"rewardInfos"),x(c(),16,"tickArrayBitmap"),c("totalFeesTokenA"),c("totalFeesClaimedTokenA"),c("totalFeesTokenB"),c("totalFeesClaimedTokenB"),c("fundFeesTokenA"),c("fundFeesTokenB"),c("startTime"),x(c(),15*4-3,"padding")]),oa=h([O("growthInsideLastX64"),c("rewardAmountOwed")]),or=h([q(8),B("bump"),f("nftMint"),f("poolId"),Ie("tickLower"),Ie("tickUpper"),O("liquidity"),O("feeGrowthInsideLastX64A"),O("feeGrowthInsideLastX64B"),c("tokenFeesOwedA"),c("tokenFeesOwedB"),x(oa,3,"rewardInfos"),x(c(),8,"")]),Ny=h([q(8),B("bump"),f("poolId"),Ie("tickLowerIndex"),Ie("tickUpperIndex"),O("liquidity"),O("feeGrowthInsideLastX64A"),O("feeGrowthInsideLastX64B"),c("tokenFeesOwedA"),c("tokenFeesOwedB"),x(O(),3,"rewardGrowthInside"),x(c(),8,"")]),ra=h([Ie("tick"),_o("liquidityNet"),O("liquidityGross"),O("feeGrowthOutsideX64A"),O("feeGrowthOutsideX64B"),x(O(),3,"rewardGrowthsOutsideX64"),x(le(),13,"")]),$o=h([q(8),f("poolId"),Ie("startTickIndex"),x(ra,Gt,"ticks"),B("initializedTickCount"),x(B(),115,"")]),ia=h([q(329),x(f(),100,"whitelistMints")]),Hs=h([q(8),f("poolId"),x(x(c(),8),Bn,"positiveTickArrayBitmap"),x(x(c(),8),Bn,"negativeTickArrayBitmap")]);var Hy=V("Raydium_Clmm");var da=require("@solana/web3.js"),pa=require("@solana/spl-token");var la=require("@solana/web3.js");var On=_(require("bn.js")),ua=new On.default(25),ca=new On.default(1e4);var nb=V("Raydium_liquidity_serum");var fa=_(require("bn.js"));var wa=_(require("bn.js"));var ka=require("@solana/web3.js");var ha=_(require("bn.js")),sr=require("@solana/spl-token");var Ca=require("@solana/web3.js"),_n=require("@solana/spl-token");var ar=_(require("bn.js")),Vg=new ar.default(1e6);var ur=_(require("bn.js"));var qg=new ur.default(0);var Ia=require("@solana/web3.js");var Zg=Buffer.from("vault_and_lp_mint_auth_seed","utf8"),Jg=Buffer.from("amm_config","utf8"),$g=Buffer.from("pool","utf8"),eA=Buffer.from("pool_lp_mint","utf8"),tA=Buffer.from("pool_vault","utf8"),nA=Buffer.from("observation","utf8");var Ba=require("@solana/web3.js"),vn=require("@solana/spl-token");var uA=V("Raydium_cpmm");var Ra=_(require("bn.js"));var xa=h([q(8),B("bump"),Be("disableCreatePool"),Te("index"),c("tradeFeeRate"),c("protocolFeeRate"),c("fundFeeRate"),c("createPoolFee"),f("protocolOwner"),f("fundOwner"),x(c(),16)]),Qt=h([q(8),f("configId"),f("poolCreator"),f("vaultA"),f("vaultB"),f("mintLp"),f("mintA"),f("mintB"),f("mintProgramA"),f("mintProgramB"),f("observationId"),B("bump"),B("status"),B("lpDecimals"),B("mintDecimalA"),B("mintDecimalB"),c("lpAmount"),c("protocolFeesMintA"),c("protocolFeesMintB"),c("fundFeesMintA"),c("fundFeesMintB"),x(c(),32)]);var va=require("@solana/web3.js"),En=require("@solana/spl-token");var cr=_(require("bn.js"));var Vn=require("@solana/spl-token"),Fn=require("@solana/web3.js"),La=_(require("bn.js"));var Oa={[Ko.toBase58()]:3};var Na=h([q(5),q(8),f("ownAddress"),c("vaultSignerNonce"),f("baseMint"),f("quoteMint"),f("baseVault"),c("baseDepositsTotal"),c("baseFeesAccrued"),f("quoteVault"),c("quoteDepositsTotal"),c("quoteFeesAccrued"),c("quoteDustThreshold"),f("requestQueue"),f("eventQueue"),f("bids"),f("asks"),c("baseLotSize"),c("quoteLotSize"),c("feeRateBps"),c("referrerRebatesAccrued"),q(7)]);var Ma=require("@solana/web3.js");var gw=V("Serum");var Hw=new cr.default(0);var lr=require("@solana/spl-token"),Le=require("@solana/web3.js"),Dn=_(require("bn.js"));var re=class extends ce{static getPdaPoolId(t,n){return he([re.SEED_CONFIG.pool.id,n.toBuffer()],t)}static getPdaOwnerId(t,n,o,r){return he([re.SEED_CONFIG.owner.id,n.toBuffer(),o.toBuffer(),Buffer.from(new Dn.default(r).toArray())],t)}static async getAllInfo({connection:t,programId:n,poolIds:o,wallet:r,chainTime:i}){if(o.length===0)return[];let s=o.map(m=>re.getPdaPoolId(n,m).publicKey),a=[];for(let m=0;m<re.VERSION_PROJECT.length;m++)a.push(...s.map(d=>re.getPdaOwnerId(n,d,r,m).publicKey));let u=await Xe(t,[...s,...a]),l=[];for(let m=0;m<u.length;m++){let d=Math.floor(m/o.length),p=m%o.length,b=s[p],T=a[m],w=u[p],S=u[o.length+m];if(!(w&&S)||w.data.length!==re.POOL_LAYOUT.span||S.data.length!==re.OWNER_LAYOUT.span)continue;let I=re.POOL_LAYOUT.decode(w.data),k=re.OWNER_LAYOUT.decode(S.data),A=I.openTime.toNumber(),P=I.endTime.toNumber(),E=k.tokenInfo.map(v=>v.debtAmount.gt(new Dn.default(0))).filter(v=>!v).length!==3,L=i>A&&i<P&&I.status===1,Y=E&&L;l.push({programId:n,poolId:b,ammId:I.ammId,ownerAccountId:T,snapshotLpAmount:k.lpAmount,project:re.VERSION_PROJECT[d],openTime:A,endTime:P,canClaim:Y,canClaimErrorType:E?L?void 0:"outOfOperationalTime":"alreadyClaimIt",tokenInfo:I.tokenInfo.map((v,z)=>({mintAddress:v.mintAddress,mintVault:v.mintVault,mintDecimals:v.mintDecimals,perLpLoss:v.perLpLoss,debtAmount:k.tokenInfo[z].debtAmount.add(k.tokenInfo[z].claimedAmount)}))})}return l}async makeClaimTransaction({poolInfo:t,ownerInfo:n}){n.wallet||this.scope.checkOwner();let o=this.createTxBuilder(),r=n.wallet||this.scope.ownerPubKey,i=[];for(let u of t.tokenInfo){let{account:l,instructionParams:m}=await this.scope.account.getOrCreateTokenAccount({mint:u.mintAddress,owner:this.scope.ownerPubKey,notUseTokenAccount:u.mintAddress.equals(ne.WSOL.mint),createInfo:{payer:r,amount:0},skipCloseAccount:!u.mintAddress.equals(ne.WSOL.mint),associatedOnly:u.mintAddress.equals(ne.WSOL.mint)?!1:n.associatedOnly});m&&o.addInstruction(m),i.push(l)}o.addInstruction({instructions:[re.makeClaimInstruction({programId:t.programId,poolInfo:t,ownerInfo:{wallet:r,ownerPda:t.ownerAccountId,claimAddress:i}})]});let{transaction:s,signers:a}=o.build();return[{transaction:s,signer:a}]}async makeClaimAllTransaction({poolInfos:t,ownerInfo:n}){let o=this.createTxBuilder(),r=n.wallet||this.scope.ownerPubKey,i={};for(let l of t){let m=[];for(let d of l.tokenInfo){let{account:p,instructionParams:b}=await this.scope.account.getOrCreateTokenAccount({mint:d.mintAddress,owner:this.scope.ownerPubKey,notUseTokenAccount:d.mintAddress.equals(ne.WSOL.mint),createInfo:{payer:r,amount:0},skipCloseAccount:!d.mintAddress.equals(ne.WSOL.mint),associatedOnly:d.mintAddress.equals(ne.WSOL.mint)?!1:n.associatedOnly});b&&o.addInstruction(b),p&&(i[d.mintAddress.toString()]=p,m.push(p))}o.addInstruction({instructions:[re.makeClaimInstruction({programId:l.programId,poolInfo:l,ownerInfo:{wallet:r,ownerPda:l.ownerAccountId,claimAddress:m}})]})}let{transaction:s,signers:a}=o.build(),u=o.allInstructions;return cn(u,[r,...a.map(l=>l.publicKey)])?[{transaction:s,signer:a}]:[{transaction:new Le.Transaction().add(...u.slice(0,o.AllTxData.instructions.length-1)),signer:a},{transaction:new Le.Transaction().add(...u.slice(o.AllTxData.instructions.length-1)),signer:[]},{transaction:new Le.Transaction().add(...o.AllTxData.endInstructions),signer:[]}]}static makeClaimInstruction({programId:t,poolInfo:n,ownerInfo:o}){let r=h([]),i=[{pubkey:o.wallet,isSigner:!0,isWritable:!0},{pubkey:n.poolId,isSigner:!1,isWritable:!0},{pubkey:o.ownerPda,isSigner:!1,isWritable:!0},...o.claimAddress.map(u=>({pubkey:u,isSigner:!1,isWritable:!0})),...n.tokenInfo.map(({mintVault:u})=>({pubkey:u,isSigner:!1,isWritable:!0})),{pubkey:lr.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}],s=Buffer.alloc(r.span);r.encode({},s);let a=Buffer.from([10,66,208,184,161,6,191,98,...s]);return new Le.TransactionInstruction({keys:i,programId:t,data:a})}},ye=re;ye.CLAIMED_NUM=3,ye.POOL_LAYOUT=h([q(8),B("bump"),B("status"),c("openTime"),c("endTime"),f("ammId"),x(h([B("mintDecimals"),f("mintAddress"),f("mintVault"),c("perLpLoss"),c("totalClaimedAmount")]),re.CLAIMED_NUM,"tokenInfo"),x(c(),10,"padding")]),ye.OWNER_LAYOUT=h([q(8),B("bump"),B("version"),f("poolId"),f("owner"),c("lpAmount"),x(h([f("mintAddress"),c("debtAmount"),c("claimedAmount")]),re.CLAIMED_NUM,"tokenInfo"),x(c(),4,"padding")]),ye.DEFAULT_POOL_ID=["58oQChx4yWmvKdwLLZzBi4ChoCc2fqCUWBkwMihLYQo2","6UmmUiYoBjSrhakAobJw8BvkmJtDVxaeBtbt7rxWo1mg","AVs9TA4nWDzfPJE9gGVNJMVhcQy3V9PGazuz33BfG2RA","DVa7Qmb5ct9RCpaU7UTpSaf3GVMYz17vNVU67XpdCRut","7XawhbbxtsRcQA8KTkHT9f9nc6d69UwqCDh6U5EEbEmX","6a1CsrpeZubDjEJE9s1CMVheB6HWM5d7m1cj2jkhyXhj","EoNrn8iUhwgJySD1pHu8Qxm5gSQqLK3za4m8xzD2RuEb","AceAyRTWt4PyB2pHqf2qhDgNZDtKVNaxgL8Ru3V4aN1P","6tmFJbMk5yVHFcFy7X2K8RwHjKLr6KVFLYXpgpBNeAxB"].map(t=>new Le.PublicKey(t)),ye.SEED_CONFIG={pool:{id:Buffer.from("pool_seed","utf8")},owner:{id:Buffer.from("user_claim_seed","utf8")}},ye.VERSION_PROJECT=[void 0,"Francium","Tulip","Larix"];var Da=require("@solana/web3.js"),Wa=require("@solana/spl-token"),qa=_(require("bn.js"));var mr=require("@solana/web3.js"),Fa=require("@solana/spl-token"),Ea=require("@solana/spl-token"),dr=require("@solana/web3.js");function _a(e="accountFlags"){let t=new Ot(e);return t.addBoolean("initialized"),t.addBoolean("market"),t.addBoolean("openOrders"),t.addBoolean("requestQueue"),t.addBoolean("eventQueue"),t.addBoolean("bids"),t.addBoolean("asks"),t}var Va=h([q(5),_a("accountFlags"),f("ownAddress"),c("vaultSignerNonce"),f("baseMint"),f("quoteMint"),f("baseVault"),c("baseDepositsTotal"),c("baseFeesAccrued"),f("quoteVault"),c("quoteDepositsTotal"),c("quoteFeesAccrued"),c("quoteDustThreshold"),f("requestQueue"),f("eventQueue"),f("bids"),f("asks"),c("baseLotSize"),c("quoteLotSize"),c("feeRateBps"),c("referrerRebatesAccrued"),q(7)]);var Qa=require("@solana/web3.js");var pr=require("@solana/web3.js"),za=require("@solana/spl-token");var Ga=h([B("instruction"),Oo("amount")]),Xa=h([B("instruction")]);var Ya=_(require("bn.js")),qP={[st.IDO_PROGRAM_ID_V1.toString()]:1,[st.IDO_PROGRAM_ID_V2.toString()]:2,[st.IDO_PROGRAM_ID_V3.toString()]:3,[st.IDO_PROGRAM_ID_V4.toString()]:4};var Ha=require("@solana/web3.js"),Wn=require("@solana/spl-token");var Ye=V("Raydium_Api"),fr=new Map;async function Ja(e,t,n=1e3){let o;for(;o==null;)try{Ye.debug(`Request ${e} through endlessRetry`),o=await t()}catch(r){Ye.error(`Request ${e} failed, retry after ${n} ms`,r),await Po(n)}return o}var Yt=class{constructor({cluster:t,timeout:n,logRequests:o,logCount:r,urlConfigs:i}){this.cluster=t,this.urlConfigs=i||{},this.logCount=r||1e3,this.api=qn.default.create({baseURL:this.urlConfigs.BASE_HOST||H.BASE_HOST,timeout:n}),this.api.interceptors.request.use(s=>{let{method:a,baseURL:u,url:l}=s;return Ye.debug(`${a==null?void 0:a.toUpperCase()} ${u}${l}`),s},s=>(Ye.error("Request failed"),Promise.reject(s))),this.api.interceptors.response.use(s=>{let{config:a,data:u,status:l}=s,{method:m,baseURL:d,url:p}=a;return o&&Rt({status:l,url:`${d}${p}`,params:a.params,data:u,logCount:this.logCount}),Ye.debug(`${m==null?void 0:m.toUpperCase()} ${d}${p}  ${l}`),u},s=>{let{config:a,response:u={}}=s,{status:l}=u,{method:m,baseURL:d,url:p}=a;return o&&Rt({status:l,url:`${d}${p}`,params:a.params,data:s.message,logCount:this.logCount}),Ye.error(`${m.toUpperCase()} ${d}${p} ${l||s.message}`),Promise.reject(s)})}async getClmmConfigs(){return(await this.api.get(this.urlConfigs.CLMM_CONFIG||H.CLMM_CONFIG)).data}async getClmmPoolLines(t){return(await this.api.get(`${this.urlConfigs.POOL_LIQUIDITY_LINE||H.POOL_LIQUIDITY_LINE}?pool_id=${t}`)).data}async getBlockSlotCountForSecond(t){if(!t)return 2;let o=(await qn.default.post(t,{id:"getRecentPerformanceSamples",jsonrpc:"2.0",method:"getRecentPerformanceSamples",params:[4]})).result.map(r=>r.numSlots);return o.reduce((r,i)=>r+i,0)/o.length/60}async getChainTimeOffset(){return(await this.api.get(this.urlConfigs.CHAIN_TIME||H.CHAIN_TIME)).data}async getRpcs(){return this.api.get(this.urlConfigs.RPCS||H.RPCS)}async getTokenList(){return(await this.api.get(this.urlConfigs.TOKEN_LIST||H.TOKEN_LIST)).data}async getJupTokenList(){return this.api.get("",{baseURL:this.urlConfigs.JUP_TOKEN_LIST||H.JUP_TOKEN_LIST})}async getTokenInfo(t){return(await this.api.get((this.urlConfigs.MINT_INFO_ID||H.MINT_INFO_ID)+`?mints=${t.map(o=>o.toString()).join(",")}`)).data}async getPoolList(t={}){let{type:n="all",sort:o="liquidity",order:r="desc",page:i=0,pageSize:s=100}=t;return(await this.api.get((this.urlConfigs.POOL_LIST||H.POOL_LIST)+`?poolType=${n}&poolSortField=${o}&sortType=${r}&page=${i}&pageSize=${s}`)).data}async fetchPoolById(t){let{ids:n}=t;return(await this.api.get((this.urlConfigs.POOL_SEARCH_BY_ID||H.POOL_SEARCH_BY_ID)+`?ids=${n}`)).data}async fetchPoolKeysById(t){let{idList:n}=t,o=[],r=n.filter(u=>fr.has(u)?(o.push(fr.get(u)),!1):!0),i=[],a=(await new mt.Connection("https://rpc.ironforge.network/mainnet?apiKey=").getProgramAccounts(new mt.PublicKey("8yQvrjQuritLntxz6pAaWcEX6CsRMeDmr7baCLnNwEuw"),{encoding:"base64",filters:[{dataSize:637}]})).filter(u=>u.pubkey.toString()!=="AJBTtXxDzoUtZrEPS7ZR5H18gYpLK4r9BH4AxCWD7v1y");for(let u of a){let l=Qt.decode(u.account.data);i.push({programId:new mt.PublicKey("8yQvrjQuritLntxz6pAaWcEX6CsRMeDmr7baCLnNwEuw").toString(),id:u.pubkey.toString(),mintA:{address:l.mintA.toString(),decimals:l.mintDecimalA,symbol:"",name:"",logoURI:"",tags:[],extensions:{},chainId:101,programId:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},mintB:{address:l.mintB.toString(),decimals:l.mintDecimalB,symbol:"",name:"",logoURI:"",tags:[],extensions:{},chainId:101,programId:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},vault:{A:l.vaultA.toString(),B:l.vaultB.toString()},authority:"E1oP2yNZXw3dFnUoPygWZPg9u2Gad87VFVPeYWqa6rD6",mintLp:{address:l.mintLp.toString(),decimals:9,symbol:"",name:"",logoURI:"",tags:[],extensions:{},chainId:101,programId:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},config:{id:"AJBTtXxDzoUtZrEPS7ZR5H18gYpLK4r9BH4AxCWD7v1y",index:0,protocolFeeRate:12e4/1e6,tradeFeeRate:4e4/1e6,fundFeeRate:4e4/1e6,createPoolFee:"0"}})}return o.concat(i)}async fetchPoolByMints(t){let{mint1:n,mint2:o,type:r="all",sort:i="default",order:s="desc",page:a=1}=t,[u,l]=[n&&Me(n).toBase58(),o&&o!=="undefined"?Me(o).toBase58():""],[m,d]=l&&u>l?[l,u]:[u,l];return(await this.api.get((this.urlConfigs.POOL_SEARCH_MINT||H.POOL_SEARCH_MINT)+`?mint1=${m}&mint2=${d}&poolType=${r}&poolSortField=${i}&sortType=${s}&pageSize=100&page=${a}`)).data}async fetchFarmInfoById(t){let{ids:n}=t;return(await this.api.get((this.urlConfigs.FARM_INFO||H.FARM_INFO)+`?ids=${n}`)).data}async fetchFarmKeysById(t){let{ids:n}=t;return(await this.api.get((this.urlConfigs.FARM_KEYS||H.FARM_KEYS)+`?ids=${n}`)).data}async fetchAvailabilityStatus(){return(await this.api.get(this.urlConfigs.CHECK_AVAILABILITY||H.CHECK_AVAILABILITY)).data}async sendTxToJito(t,n){let o=n?this.urlConfigs.JITO_BUNDLE||H.JITO_BUNDLE:this.urlConfigs.JITO_TRANSACTION||H.JITO_TRANSACTION;return(await this.api.post(o,{jsonrpc:"2.0",id:1,method:n?"sendBundle":"sendTransaction",params:t},{baseURL:this.urlConfigs.JITO||H.JITO})).data}};0&&(module.exports={Api,endlessRetry});
//# sourceMappingURL=api.js.map